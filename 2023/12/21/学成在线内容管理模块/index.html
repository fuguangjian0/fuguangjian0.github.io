

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="fgj">
  <meta name="keywords" content="">
  
    <meta name="description" content="学成在线内容管理模块模块需求分析开发人员经过分析, 理解用户和项目的功能,性能,可靠性等要求, 搞清楚问题域  确认用户需求 确认关键问题 梳理业务流程 数据建模 编写需求规格说明书     项目 添加课程    功能名称 添加课程   功能描述 添加课程基本信息   参与者 教学机构管理员   前置条件 教学机构管理只允许向自己机构添加课程 拥有添加课程的权限   基本事件流程 1、登录教学机构">
<meta property="og:type" content="article">
<meta property="og:title" content="学成在线内容管理模块">
<meta property="og:url" content="http://example.com/2023/12/21/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BF%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/index.html">
<meta property="og:site_name" content="FGJ">
<meta property="og:description" content="学成在线内容管理模块模块需求分析开发人员经过分析, 理解用户和项目的功能,性能,可靠性等要求, 搞清楚问题域  确认用户需求 确认关键问题 梳理业务流程 数据建模 编写需求规格说明书     项目 添加课程    功能名称 添加课程   功能描述 添加课程基本信息   参与者 教学机构管理员   前置条件 教学机构管理只允许向自己机构添加课程 拥有添加课程的权限   基本事件流程 1、登录教学机构">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212101711553.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212102711295.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212102805059.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212102837723.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212102937547.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212105034210.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212105831280.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212105841097.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231211223829806.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212112002588.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212112214740.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212112250372.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212152835665.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212153130979.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212153226561.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212155347584.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212155724678.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212155804817.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212175600088.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212181131393.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212210013694.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212210110700.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212210652261.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212210658181.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212210916532.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212221419802.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213154939950.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213155131812.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213165458999.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213165734568.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213165812252.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213165825088.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213165907293.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213170043851.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213170138973.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213170214715.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213170510366.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213170517609.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213182004016.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213182458219.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213182803776.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213194604949.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213203014473.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213203142283.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213203712220.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213203753785.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213210424490.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213214404537.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213214452277.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213214637577.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213214645689.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213232628012.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214105555310.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214105757191.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214110323538.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214121739423.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214145130166.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214164531094.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214171959494.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214171916310.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214172750117.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214175223100.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214175317252.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214214329437.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214214351329.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214214407963.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214214445298.png">
<meta property="og:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214232831531.png">
<meta property="article:published_time" content="2023-12-21T13:16:24.000Z">
<meta property="article:modified_time" content="2024-01-14T07:34:24.430Z">
<meta property="article:author" content="fgj">
<meta property="article:tag" content="学成在线">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212101711553.png">
  
  
  
  <title>学成在线内容管理模块 - FGJ</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Home</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://fgj2.oss-cn-beijing.aliyuncs.com/ddd.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="学成在线内容管理模块"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-12-21 21:16" pubdate>
          2023年12月21日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          85k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          712 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">学成在线内容管理模块</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="学成在线"><a href="#学成在线" class="headerlink" title="学成在线"></a>学成在线</h1><h2 id="内容管理模块"><a href="#内容管理模块" class="headerlink" title="内容管理模块"></a>内容管理模块</h2><h3 id="模块需求分析"><a href="#模块需求分析" class="headerlink" title="模块需求分析"></a>模块需求分析</h3><p>开发人员经过分析, 理解用户和项目的<code>功能,性能,可靠性</code>等要求, 搞清楚<code>问题域</code></p>
<ol>
<li>确认用户需求</li>
<li>确认关键问题</li>
<li>梳理业务流程</li>
<li>数据建模</li>
<li>编写需求规格说明书</li>
</ol>
<table>
<thead>
<tr>
<th>项目</th>
<th>添加课程</th>
</tr>
</thead>
<tbody><tr>
<td>功能名称</td>
<td>添加课程</td>
</tr>
<tr>
<td>功能描述</td>
<td>添加课程基本信息</td>
</tr>
<tr>
<td>参与者</td>
<td>教学机构管理员</td>
</tr>
<tr>
<td>前置条件</td>
<td>教学机构管理只允许向自己机构添加课程 拥有添加课程的权限</td>
</tr>
<tr>
<td>基本事件流程</td>
<td>1、登录教学机构平台  2、进入课程列表页面  3、点击添加课程按钮进入添加课程界面  4、填写课程基本信息  5、点击提交。</td>
</tr>
<tr>
<td>可选事件流程</td>
<td>成功：提示添加成功，跳转到课程营销信息添加界面 失败：提示具体的失败信息，用户根据失败信息进行修改。</td>
</tr>
<tr>
<td>数据描述</td>
<td>课程基本信息：课程id、课程名称、课程介绍、课程大分类、课程小分类、课程等级、课程图片、所属机构、课程创建时间、课程修改时间、课程状态</td>
</tr>
<tr>
<td>后置条件</td>
<td>向课程基本信息插入一条记录</td>
</tr>
<tr>
<td>补充说明</td>
<td></td>
</tr>
</tbody></table>
<p>本项目作为一个大型在线教育平台, <code>内容管理模块</code>主要<code>对课程和相关内容进行管理</code></p>
<p>本模块所有表</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212101711553.png" srcset="/img/loading.gif" lazyload alt="image-20231212101711553"></p>
<hr>
<h3 id="创建模块工程"><a href="#创建模块工程" class="headerlink" title="创建模块工程"></a>创建模块工程</h3><p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212102711295.png" srcset="/img/loading.gif" lazyload alt="image-20231212102711295"></p>
<p><strong>前后端交互交互流程图</strong></p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212102805059.png" srcset="/img/loading.gif" lazyload alt="image-20231212102805059"></p>
<p><strong>内容管理所有模块结构</strong></p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212102837723.png" srcset="/img/loading.gif" lazyload alt="image-20231212102837723"></p>
<ul>
<li>xuecheng-plus-content：内容管理模块工程，负责聚合xuecheng-plus-content-api、xuecheng-plus-content-service、xuecheng-plus-content-model。</li>
<li>xuecheng-plus-content-api：接口工程，为前端提供接口。</li>
<li>xuecheng-plus-content-service: 业务工程，为接口工程提供业务支撑。</li>
<li>xuecheng-plus-content-model: 数据模型工程，存储数据模型类、数据传输类型等。</li>
</ul>
<p><strong>结合 父工程 和 基础工程流程图</strong></p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212102937547.png" srcset="/img/loading.gif" lazyload alt="image-20231212102937547"></p>
<hr>
<p>在IDEA创建这样的模块结构</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212105034210.png" srcset="/img/loading.gif" lazyload alt="image-20231212105034210"></p>
<p>4个pom.xml初始内容, 从上向下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.xuecheng<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xuecheng-plus-content<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xuecheng-plus-content-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.xuecheng<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xuecheng-plus-content-service<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.xuecheng<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xuecheng-plus-content<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xuecheng-plus-content-model<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.xuecheng<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xuecheng-plus-base<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.xuecheng<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xuecheng-plus-content<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xuecheng-plus-content-service<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.xuecheng<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xuecheng-plus-content-model<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.xuecheng<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xuecheng-plus-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>&gt;</span>../xuecheng-plus-parent<span class="hljs-tag">&lt;/<span class="hljs-name">relativePath</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xuecheng-plus-content<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>xuecheng-plus-content<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">description</span>&gt;</span>xuecheng-plus-content<span class="hljs-tag">&lt;/<span class="hljs-name">description</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">packaging</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">packaging</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modules</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">module</span>&gt;</span>xuecheng-plus-content-model<span class="hljs-tag">&lt;/<span class="hljs-name">module</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">module</span>&gt;</span>xuecheng-plus-content-service<span class="hljs-tag">&lt;/<span class="hljs-name">module</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">module</span>&gt;</span>xuecheng-plus-content-api<span class="hljs-tag">&lt;/<span class="hljs-name">module</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">modules</span>&gt;</span><br><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="课程查询"><a href="#课程查询" class="headerlink" title="课程查询"></a>课程查询</h3><h4 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a><strong>需求分析</strong></h4><p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212105831280.png" srcset="/img/loading.gif" lazyload alt="image-20231212105831280"></p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212105841097.png" srcset="/img/loading.gif" lazyload alt="image-20231212105841097"></p>
<p><strong>数据模型</strong></p>
<p>查询条件: </p>
<ol>
<li>课程名称 : 模糊搜索</li>
<li>课程审核状态 : 未提交, 已提交, 审核通过, 审核未通过</li>
<li>课程发布状态 : 未发布, 已发布, 已下线</li>
<li>分页查询: 页码, 每页显示记录数</li>
</ol>
<p>查询结果:</p>
<p>课程id,  课程名称, 创建时间，审核状态, 操作</p>
<p>任务数: 该课程包含的课程计划数, 即课程章节数</p>
<p>是否付费: 免费, 收费</p>
<p>类型: 录播, 直播</p>
<p>分页查询: 页码, 每页显示记录数</p>
<h4 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a><strong>创建数据库</strong></h4><p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231211223829806.png" srcset="/img/loading.gif" lazyload alt="image-20231211223829806"></p>
<blockquote>
<p>面试</p>
<ol>
<li>MySQL 常见存储引擎及区别?</li>
</ol>
<p>InnoDB : 支持<code>事务</code>, 使用锁粒度默认为<code>行级锁</code>, 支持更高并发, 支持<code>表锁</code>;  支持<code>外键</code>约束, 降低表的查询速度, 增加表之间的耦合, 降低表的独立性;  </p>
<p>MyISAM : 不支持<code>事务</code>, 只支持<code>表级锁</code>, 不支持<code>外键</code></p>
<p>memory: 数据存储在<code>内存</code></p>
<p>总结: </p>
<ul>
<li>MyISAM 管理非事务表, 提供高速<code>存储</code>和<code>检索</code>以及全文<code>搜索</code>能力, 如果在应用执行大量<code>select</code> , 应该选择MyISAM</li>
<li>InnoDB  用于<code>事务处理</code>, 具有<code>ACID</code> 事务支持等特性, 如果应用中执行大量<code>insert </code>和 <code>update</code> 操作, 应该选择InnoDB</li>
</ul>
<ol start="2">
<li><p>MySQL 建表需要注意什么?</p>
</li>
<li><p>注意选择存储引擎, 支持事务要选InnoDB</p>
</li>
<li><p>注意字段类型选择， 日期类型如果要记录分秒时使用datetime , 只记录年月日使用date类型, 对于字符类型的选择,固定长度选择char, 不固定长度选择varchar ,  varchar比char节省空间但速度慢, 对于内容介绍类的长广文本字段使用text或longtext ,  如果存储图片等二进制数据使用blob 或 longblob  , 对于金额字段建议使用decimal , 对于数值类型在取值范围足够的前提尽量使用占用空间小的</p>
</li>
<li><p>主键尽量使用自然主键, 不要有业务意义, 使用int unsigned类型, 特殊可以bigint</p>
</li>
<li><p>如果要存储text blob 字段建议单独一张表, 使用外键关联</p>
</li>
<li><p>尽量不定义外键, 保证表的独立性, 可以存在外键意义的字段</p>
</li>
<li><p>设置字段默认值, 比如: 状态, 创建时间等</p>
</li>
<li><p>每个字段注释写明白</p>
</li>
<li><p>注意字段约束, 非空, 唯一, 主键等</p>
</li>
</ol>
</blockquote>
<p><strong>生成PO类</strong></p>
<p>PO是持久层对象, 由一组属性和属性get和set方法组成, PO对应于数据库的表, 在开发持久层代码需要根据数据表编写PO类, 在实际开发通常使用代码生成器(工具)生成PO类的代码</p>
<p>由于在需求分析阶段对数据模型分析, PO类对应于数据模型, 所以在需求分析阶段即可使用工具生成PO类</p>
<p>本项目使用 MP 生成PO类 Mapper接口 Mapper的xml文件</p>
<p><a target="_blank" rel="noopener" href="https://github.com/baomidou/generator">https://github.com/baomidou/generator</a></p>
<p>导入资料中的xuecheng-plus-generator</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212112002588.png" srcset="/img/loading.gif" lazyload alt="image-20231212112002588"></p>
<p>这个内容管理模块的PO类, Mapper接口和Mapper的xml文件, 我们这里只用PO</p>
<p>ContentCoderGenerator.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.generator;<br><br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.annotation.DbType;<br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.annotation.FieldFill;<br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.generator.AutoGenerator;<br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.generator.config.*;<br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.generator.config.po.TableFill;<br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.generator.config.rules.NamingStrategy;<br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.generator.engine.FreemarkerTemplateEngine;<br><br><span class="hljs-keyword">import</span> java.util.Arrays;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * MyBatis-Plus 代码生成类</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ContentCodeGenerator</span> &#123;<br><br>    <span class="hljs-comment">// TODO 修改服务名以及数据表名</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">SERVICE_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;content&quot;</span>;<br><br>    <span class="hljs-comment">//数据库账号</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">DATA_SOURCE_USER_NAME</span>  <span class="hljs-operator">=</span> <span class="hljs-string">&quot;root&quot;</span>;<br>    <span class="hljs-comment">//数据库密码</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">DATA_SOURCE_PASSWORD</span>  <span class="hljs-operator">=</span> <span class="hljs-string">&quot;mysql&quot;</span>;<br>    <span class="hljs-comment">//生成的表</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String[] TABLE_NAMES = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]&#123;<br><span class="hljs-comment">//        &quot;mq_message&quot;,</span><br><span class="hljs-comment">//        &quot;mq_message_history&quot;</span><br>           <span class="hljs-string">&quot;course_base&quot;</span>,<br>           <span class="hljs-string">&quot;course_market&quot;</span>,<br>           <span class="hljs-string">&quot;teachplan&quot;</span>,<br>           <span class="hljs-string">&quot;teachplan_media&quot;</span>,<br>           <span class="hljs-string">&quot;course_teacher&quot;</span>,<br>          <span class="hljs-string">&quot;course_category&quot;</span>,<br>           <span class="hljs-string">&quot;course_publish&quot;</span>,<br>           <span class="hljs-string">&quot;course_publish_pre&quot;</span><br><br>    &#125;;<br><br>    <span class="hljs-comment">// TODO 默认生成entity，需要生成DTO修改此变量</span><br>    <span class="hljs-comment">// 一般情况下要先生成 DTO类 然后修改此参数再生成 PO 类。</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Boolean</span> <span class="hljs-variable">IS_DTO</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>       <span class="hljs-comment">// 代码生成器</span><br>       <span class="hljs-type">AutoGenerator</span> <span class="hljs-variable">mpg</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AutoGenerator</span>();<br>       <span class="hljs-comment">// 选择 freemarker 引擎，默认 Velocity</span><br>       mpg.setTemplateEngine(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FreemarkerTemplateEngine</span>());<br>       <span class="hljs-comment">// 全局配置</span><br>       <span class="hljs-type">GlobalConfig</span> <span class="hljs-variable">gc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">GlobalConfig</span>();<br>       gc.setFileOverride(<span class="hljs-literal">true</span>);<br>       <span class="hljs-comment">//生成路径</span><br>       gc.setOutputDir(System.getProperty(<span class="hljs-string">&quot;user.dir&quot;</span>) + <span class="hljs-string">&quot;/xuecheng-plus-generator/src/main/java&quot;</span>);<br>       gc.setAuthor(<span class="hljs-string">&quot;itcast&quot;</span>);<br>       gc.setOpen(<span class="hljs-literal">false</span>);<br>       gc.setSwagger2(<span class="hljs-literal">false</span>);<br>       gc.setServiceName(<span class="hljs-string">&quot;%sService&quot;</span>);<br>        gc.setBaseResultMap(<span class="hljs-literal">true</span>);<br>        gc.setBaseColumnList(<span class="hljs-literal">true</span>);<br><br>       <span class="hljs-keyword">if</span> (IS_DTO) &#123;<br>          gc.setSwagger2(<span class="hljs-literal">true</span>);<br>          gc.setEntityName(<span class="hljs-string">&quot;%sDTO&quot;</span>);<br>       &#125;<br>       mpg.setGlobalConfig(gc);<br><br>       <span class="hljs-comment">// 数据库配置</span><br>       <span class="hljs-type">DataSourceConfig</span> <span class="hljs-variable">dsc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataSourceConfig</span>();<br>       dsc.setDbType(DbType.MYSQL);<br>       dsc.setUrl(<span class="hljs-string">&quot;jdbc:mysql://192.168.101.65:3306/xc402_&quot;</span> + SERVICE_NAME<br>             + <span class="hljs-string">&quot;?serverTimezone=UTC&amp;useUnicode=true&amp;useSSL=false&amp;characterEncoding=utf8&quot;</span>);<br><span class="hljs-comment">//     dsc.setDriverName(&quot;com.mysql.jdbc.Driver&quot;);</span><br>       dsc.setDriverName(<span class="hljs-string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);<br>       dsc.setUsername(DATA_SOURCE_USER_NAME);<br>       dsc.setPassword(DATA_SOURCE_PASSWORD);<br>       mpg.setDataSource(dsc);<br><br>       <span class="hljs-comment">// 包配置</span><br>       <span class="hljs-type">PackageConfig</span> <span class="hljs-variable">pc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PackageConfig</span>();<br>       pc.setModuleName(SERVICE_NAME);<br>       pc.setParent(<span class="hljs-string">&quot;com.xuecheng&quot;</span>);<br><br>       pc.setServiceImpl(<span class="hljs-string">&quot;service.impl&quot;</span>);<br>       pc.setXml(<span class="hljs-string">&quot;mapper&quot;</span>);<br>       pc.setEntity(<span class="hljs-string">&quot;model.po&quot;</span>);<br>       mpg.setPackageInfo(pc);<br><br><br>       <span class="hljs-comment">// 设置模板</span><br>       <span class="hljs-type">TemplateConfig</span> <span class="hljs-variable">tc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TemplateConfig</span>();<br>       mpg.setTemplate(tc);<br><br>       <span class="hljs-comment">// 策略配置</span><br>       <span class="hljs-type">StrategyConfig</span> <span class="hljs-variable">strategy</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StrategyConfig</span>();<br>       strategy.setNaming(NamingStrategy.underline_to_camel);<br>       strategy.setColumnNaming(NamingStrategy.underline_to_camel);<br>       strategy.setEntityLombokModel(<span class="hljs-literal">true</span>);<br>       strategy.setRestControllerStyle(<span class="hljs-literal">true</span>);<br>       strategy.setInclude(TABLE_NAMES);<br>       strategy.setControllerMappingHyphenStyle(<span class="hljs-literal">true</span>);<br>       strategy.setTablePrefix(pc.getModuleName() + <span class="hljs-string">&quot;_&quot;</span>);<br>       <span class="hljs-comment">// Boolean类型字段是否移除is前缀处理</span><br>       strategy.setEntityBooleanColumnRemoveIsPrefix(<span class="hljs-literal">true</span>);<br>       strategy.setRestControllerStyle(<span class="hljs-literal">true</span>);<br><br>       <span class="hljs-comment">// 自动填充字段配置</span><br>       strategy.setTableFillList(Arrays.asList(<br>             <span class="hljs-keyword">new</span> <span class="hljs-title class_">TableFill</span>(<span class="hljs-string">&quot;create_date&quot;</span>, FieldFill.INSERT),<br>             <span class="hljs-keyword">new</span> <span class="hljs-title class_">TableFill</span>(<span class="hljs-string">&quot;change_date&quot;</span>, FieldFill.INSERT_UPDATE),<br>             <span class="hljs-keyword">new</span> <span class="hljs-title class_">TableFill</span>(<span class="hljs-string">&quot;modify_date&quot;</span>, FieldFill.UPDATE)<br>       ));<br>       mpg.setStrategy(strategy);<br><br>       mpg.execute();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212112214740.png" srcset="/img/loading.gif" lazyload alt="image-20231212112214740"></p>
<p>拷贝到model模块</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212112250372.png" srcset="/img/loading.gif" lazyload alt="image-20231212112250372"></p>
<p>model模块下的pom.xml添加依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.xuecheng<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xuecheng-plus-base<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.baomidou<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-plus-annotation<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;mybatis-plus-boot-starter.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.baomidou<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-plus-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;mybatis-plus-boot-starter.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="设计接口"><a href="#设计接口" class="headerlink" title="设计接口"></a><strong>设计接口</strong></h4><p>接口设计分析包括下面几个方面:</p>
<ol>
<li>协议: 一般是HTTP, 查询类接口get或post, 查询条件较少的使用get, 较多的使用post, 本接口使用http post, 还要确定content-type, 参数以什么数据格式响应, 一般json</li>
<li>分析请求参数: 根据对数据模型的分析, 请求参数: 课程名称, 课程审核状态, 当前页码, 每页显示记录数, 根据分析的请求参数定义模型类</li>
<li>分析响应结果: 根据前边对数据模型的分析, 响应结果为数据列表加一些分页信息(总记录数, 当前页, 每页显示记录数), 数据列表(课程id, 课程名称, 任务数, 创建时间, 审核状态, 类型);  根据分析的响应结果定义模型类</li>
</ol>
<blockquote>
<p>注意: 查询结果中审核状态为数据字典中的代码字段, 前端会根据审核状态代码, 找到对应的名称显示</p>
</blockquote>
<ol start="4">
<li>分析完成, 使用SpringBoot注解开发一个Http接口</li>
<li>使用接口文档工具查看接口内容</li>
<li>接口中调用service方法完成业务处理</li>
<li>接口调用service方法完成业务处理</li>
</ol>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs json">POST /content/course/list?pageNo=<span class="hljs-number">2</span>&amp;pageSize=<span class="hljs-number">1</span><br>Content-Type<span class="hljs-punctuation">:</span> application/json<br><br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;auditStatus&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;202002&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;courseName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;publishStatus&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;&quot;</span><br><span class="hljs-punctuation">&#125;</span><br>###成功响应结果<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;items&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">26</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;companyId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1232141425</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;companyName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;spring cloud实战&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;users&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;所有人&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;tags&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;mt&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-3&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;mtName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;st&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-3-2&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;stName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;grade&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;200003&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;teachmode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;201001&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;本课程主要从四个章节进行讲解： 1.微服务架构入门 2.spring cloud 基础入门 3.实战Spring Boot 4.注册中心eureka。&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;pic&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;https://cdn.educba.com/academy/wp-content/uploads/2018/08/Spring-BOOT-Interview-questions.jpg&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;createDate&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2019-09-04 09:56:19&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;changeDate&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2021-12-26 22:10:38&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;createPeople&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;changePeople&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;auditStatus&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;202002&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;auditMind&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;auditNums&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;auditDate&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;auditPeople&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;coursePubId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;coursePubDate&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;counts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">23</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;page&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;pageSize&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><br><span class="hljs-punctuation">&#125;</span><br><br></code></pre></td></tr></table></figure>

<p><strong>定义模型类</strong></p>
<p>根据接口分析需要定义模型类接收请求的参数, 定义模型类用于响应结果</p>
<ol>
<li>分页查询模型类</li>
</ol>
<p>由于分页查询接口在项目中较多, 针对<code>分页查询参数</code>(当前页码, 每页显示记录数) 单独在xuecheng-plus-base工程定义</p>
<p>PageParams.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.base.model;<br><br><span class="hljs-keyword">import</span> lombok.AllArgsConstructor;<br><span class="hljs-keyword">import</span> lombok.Data;<br><span class="hljs-keyword">import</span> lombok.NoArgsConstructor;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description</span> 分页查询通用参数</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@date</span> 2023/12/12 11:50</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-meta">@NoArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PagesParams</span> &#123;<br><br>    <span class="hljs-comment">// 当前页码</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">Long</span> <span class="hljs-variable">pageNo</span> <span class="hljs-operator">=</span> <span class="hljs-number">1L</span>;<br><br>    <span class="hljs-comment">// 每页记录数默认值</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">Long</span> <span class="hljs-variable">pageSize</span> <span class="hljs-operator">=</span> <span class="hljs-number">10L</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>查询条件模型类</li>
</ol>
<p>除了分页查询参数, 还有<code>课程查询参数</code>, 在model工程定义课程查询参数模型类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.content.model.dto;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description</span> 课程查询参数Dto</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@date</span> 2023/12/12 11:53</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">QueryCourseParamsDto</span> &#123;<br><br>    <span class="hljs-comment">// 审核状态</span><br>    <span class="hljs-keyword">private</span> String auditStatus;<br>    <span class="hljs-comment">// 课程名称</span><br>    <span class="hljs-keyword">private</span> String courseName;<br>    <span class="hljs-comment">// 发布状态</span><br>    <span class="hljs-keyword">private</span> String publishStatus;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="3">
<li>响应模型类</li>
</ol>
<p>根据接口分析, 定义响应结果模型类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.base.model;<br><br><span class="hljs-keyword">import</span> lombok.AllArgsConstructor;<br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-keyword">import</span> java.io.Serializable;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description</span> 分页查询结果模型类</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@date</span> 2023/12/12 11:56</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PageResult</span>&lt;T&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> &#123; <span class="hljs-comment">// 泛型类实现Serializable, 保持对象一致性和稳定性</span><br><br>    <span class="hljs-comment">// 数据列表: 存放数据列表, 支持泛型, 课程查询接口的返回类型可以是此模型类型</span><br>    <span class="hljs-keyword">private</span> List&lt;T&gt; items;<br>    <span class="hljs-comment">// 总记录数</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> counts;<br>    <span class="hljs-comment">// 当前页码</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> page;<br>    <span class="hljs-comment">// 每页记录数</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> pageSize;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>List中的数据类型, 根据需求分析使用生成的PO类, 课程查询接口返回结果类型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 泛型中填写CourseBase类</span><br>PageResult&lt;CourseBase&gt;<br></code></pre></td></tr></table></figure>

<ol start="4">
<li>定义接口(api模块)</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.content.api;<br><br><span class="hljs-keyword">import</span> com.xuecheng.base.model.PageResult;<br><span class="hljs-keyword">import</span> com.xuecheng.base.model.PagesParams;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.dto.QueryCourseParamsDto;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.po.CourseBase;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestBody;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description</span> 课程信息编辑接口</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@date</span> 2023/12/12 12:10</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CourseBaseInfoController</span> &#123;<br><br>    <span class="hljs-meta">@RequestMapping(&quot;/course/list&quot;)</span>  <span class="hljs-comment">// 测试不用post</span><br>    <span class="hljs-keyword">public</span> PageResult&lt;CourseBase&gt; <span class="hljs-title function_">list</span><span class="hljs-params">(PagesParams pagesParams,</span><br><span class="hljs-params">                                       <span class="hljs-meta">@RequestBody(required = false)</span> QueryCourseParamsDto queryCourseParams)</span>&#123; <span class="hljs-comment">// 接口接收两部分参数, 一部分是分页参数, 通过url 传递k-v , 另一部分是业务查询条件, 通过http body 传入 json 内容, 服务端使用RequestBody 接收json 内容, 我们在测试并没有传递json内容这里会报错</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="5">
<li>启动类(api模块)</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng;<br><br><span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description</span> xxx</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@date</span> 2023/12/12 12:17</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ContentApplication</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        SpringApplication.run(ContentApplication.class, args);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="6">
<li>添加配置文件</li>
</ol>
<p>bootstrap.yml</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">servlet:</span><br>    <span class="hljs-attr">context-path:</span> <span class="hljs-string">/content</span> <span class="hljs-comment"># 所有接口根路径</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">63040</span><br><span class="hljs-comment">#微服务配置</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">application:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">content-api</span><br>  <span class="hljs-attr">datasource:</span><br>    <span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.cj.jdbc.Driver</span><br>    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://192.168.101.65:3306/xc402_content148?serverTimezone=UTC&amp;userUnicode=true&amp;useSSL=false&amp;</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-string">mysql</span><br><span class="hljs-comment"># 日志文件配置路径</span><br><span class="hljs-attr">logging:</span><br>  <span class="hljs-attr">config:</span> <span class="hljs-string">classpath:log4j2-dev.xml</span><br></code></pre></td></tr></table></figure>

<p>log4j2-dev.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">Configuration</span> <span class="hljs-attr">monitorInterval</span>=<span class="hljs-string">&quot;180&quot;</span> <span class="hljs-attr">packages</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;logdir&quot;</span>&gt;</span>logs<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;PATTERN&quot;</span>&gt;</span>%date&#123;YYYY-MM-dd HH:mm:ss,SSS&#125; %level [%thread][%file:%line] - %msg%n%throwable<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Appenders</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Console</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;Console&quot;</span> <span class="hljs-attr">target</span>=<span class="hljs-string">&quot;SYSTEM_OUT&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">PatternLayout</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;$&#123;PATTERN&#125;&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">Console</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">RollingFile</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;ErrorAppender&quot;</span> <span class="hljs-attr">fileName</span>=<span class="hljs-string">&quot;$&#123;logdir&#125;/error.log&quot;</span></span><br><span class="hljs-tag">            <span class="hljs-attr">filePattern</span>=<span class="hljs-string">&quot;$&#123;logdir&#125;/$$&#123;date:yyyy-MM-dd&#125;/error.%d&#123;yyyy-MM-dd-HH&#125;.log&quot;</span> <span class="hljs-attr">append</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">PatternLayout</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;$&#123;PATTERN&#125;&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">ThresholdFilter</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;ERROR&quot;</span> <span class="hljs-attr">onMatch</span>=<span class="hljs-string">&quot;ACCEPT&quot;</span> <span class="hljs-attr">onMismatch</span>=<span class="hljs-string">&quot;DENY&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">Policies</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">TimeBasedTriggeringPolicy</span> <span class="hljs-attr">interval</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-attr">modulate</span>=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">Policies</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">RollingFile</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">RollingFile</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;DebugAppender&quot;</span> <span class="hljs-attr">fileName</span>=<span class="hljs-string">&quot;$&#123;logdir&#125;/info.log&quot;</span></span><br><span class="hljs-tag">            <span class="hljs-attr">filePattern</span>=<span class="hljs-string">&quot;$&#123;logdir&#125;/$$&#123;date:yyyy-MM-dd&#125;/info.%d&#123;yyyy-MM-dd-HH&#125;.log&quot;</span> <span class="hljs-attr">append</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">PatternLayout</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;$&#123;PATTERN&#125;&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">ThresholdFilter</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;DEBUG&quot;</span> <span class="hljs-attr">onMatch</span>=<span class="hljs-string">&quot;ACCEPT&quot;</span> <span class="hljs-attr">onMismatch</span>=<span class="hljs-string">&quot;DENY&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">Policies</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">TimeBasedTriggeringPolicy</span> <span class="hljs-attr">interval</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-attr">modulate</span>=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">Policies</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">RollingFile</span>&gt;</span><br>        <br>        <span class="hljs-comment">&lt;!--异步appender--&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">Async</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;AsyncAppender&quot;</span> <span class="hljs-attr">includeLocation</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">AppenderRef</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;ErrorAppender&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">AppenderRef</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;DebugAppender&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">Async</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">Appenders</span>&gt;</span><br>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">Loggers</span>&gt;</span><br>         <span class="hljs-comment">&lt;!--过滤掉spring和mybatis的一些无用的debug信息</span><br><span class="hljs-comment">        &lt;logger name=&quot;org.springframework&quot; level=&quot;INFO&quot;&gt;</span><br><span class="hljs-comment">        &lt;/logger&gt;</span><br><span class="hljs-comment">        &lt;logger name=&quot;org.mybatis&quot; level=&quot;INFO&quot;&gt;</span><br><span class="hljs-comment">        &lt;/logger&gt;--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">logger</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;cn.itcast.wanxinp2p.consumer.mapper&quot;</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;DEBUG&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">logger</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">logger</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;springfox&quot;</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;INFO&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">logger</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">logger</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;org.apache.http&quot;</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;INFO&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">logger</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">logger</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;com.netflix.discovery&quot;</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;INFO&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">logger</span>&gt;</span><br>        <br>        <span class="hljs-tag">&lt;<span class="hljs-name">logger</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;RocketmqCommon&quot;</span>  <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;INFO&quot;</span> &gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">logger</span>&gt;</span><br>       <br>       <span class="hljs-tag">&lt;<span class="hljs-name">logger</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;RocketmqRemoting&quot;</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;INFO&quot;</span>  &gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">logger</span>&gt;</span><br>       <br>       <span class="hljs-tag">&lt;<span class="hljs-name">logger</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;RocketmqClient&quot;</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;WARN&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">logger</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">logger</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;org.dromara.hmily&quot;</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;WARN&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">logger</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">logger</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;org.dromara.hmily.lottery&quot;</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;WARN&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">logger</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">logger</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;org.dromara.hmily.bonuspoint&quot;</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;WARN&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">logger</span>&gt;</span><br>       <br>        <span class="hljs-comment">&lt;!--OFF   0--&gt;</span><br>        <span class="hljs-comment">&lt;!--FATAL   100--&gt;</span><br>        <span class="hljs-comment">&lt;!--ERROR   200--&gt;</span><br>        <span class="hljs-comment">&lt;!--WARN   300--&gt;</span><br>        <span class="hljs-comment">&lt;!--INFO   400--&gt;</span><br>        <span class="hljs-comment">&lt;!--DEBUG   500--&gt;</span><br>        <span class="hljs-comment">&lt;!--TRACE   600--&gt;</span><br>        <span class="hljs-comment">&lt;!--ALL   Integer.MAX_VALUE--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Root</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;DEBUG&quot;</span> <span class="hljs-attr">includeLocation</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">AppenderRef</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;AsyncAppender&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">AppenderRef</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;Console&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">AppenderRef</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;DebugAppender&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">Root</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">Loggers</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">Configuration</span>&gt;</span><br></code></pre></td></tr></table></figure>

<ol start="7">
<li>启动</li>
</ol>
<p><a target="_blank" rel="noopener" href="http://localhost:63040/content/course/list">http://localhost:63040/content/course/list</a></p>
<p>400错误: 访问页面域名不存在或输入语法错误</p>
<p><strong>模型类的作用</strong></p>
<p>DTO数据传输对象, PO持久化对象, DTO接口层向业务层之间传输数据, PO用于业务层和持久层之间传输数据, 有些项目会设置VO对象, VO对象用在前端和接口层之间传输数据</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212152835665.png" srcset="/img/loading.gif" lazyload alt="image-20231212152835665"></p>
<p>当前端有多个平台且接口有差异需要设置VO对象用于前端和接口层传输数据</p>
<p>比如：</p>
<p>课程列表查询接口，根据需求用户在手机端也要查询课程信息，此时课程查询接口是否需要编写手机端和PC端两个接口呢？如果用户要求通过手机和PC的查询条件或查询结果不一样，此时就需要定义两个Controller课程查询接口，每个接口定义VO对象与前端传输数据。</p>
<p>手机查询：根据课程状态查询，查询结果只有课程名称和课程状态。</p>
<p>PC查询：可以根据课程名称、课程状态、课程审核状态等条件查询，查询结果也比手机查询结果内容多。</p>
<p>此时，Service业务层尽量提供一个业务接口，即使两个前端接口需要的数据不一样，Service可以提供一个最全查询结果，由Controller进行数据整合</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212153130979.png" srcset="/img/loading.gif" lazyload alt="image-20231212153130979"></p>
<p>如果前端接口没有多样性且比较固定, 可以取消VO, 只用DTO即可</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212153226561.png" srcset="/img/loading.gif" lazyload alt="image-20231212153226561"></p>
<h4 id="生成接口文档"><a href="#生成接口文档" class="headerlink" title="生成接口文档"></a><strong>生成接口文档</strong></h4><p>在前后端分离开发中通常由后端程序员设计接口，完成后需要编写接口文档，最后将文档交给前端工程师，前端工程师参考文档进行开发。</p>
<p>可以通过一些工具快速生成接口文档 ，本项目通过Swagger生成接口在线文档 。</p>
<blockquote>
<p>什么是Swagger？</p>
<p>​    OpenAPI规范（OpenAPI Specification 简称OAS）是Linux基金会的一个项目，试图通过定义一种用来描述API格式或API定义的语言，来规范RESTful服务开发过程，目前版本是V3.0，并且已经发布并开源在github上。</p>
<p>（<a target="_blank" rel="noopener" href="https://github.com/OAI/OpenAPI-Specification%EF%BC%89">https://github.com/OAI/OpenAPI-Specification）</a></p>
<p>​    Swagger是全球最大的OpenAPI规范（OAS）API开发工具框架，Swagger是一个在线接口文档的生成工具，前后端开发人员依据接口文档进行开发。 (<a target="_blank" rel="noopener" href="https://swagger.io/">https://swagger.io/</a>)</p>
<p>Spring Boot 可以集成Swagger，Swaager根据Controller类中的注解生成接口文档 ，只要添加Swagger的依赖和配置信息即可使用它。</p>
</blockquote>
<ol>
<li>api工程添加依赖</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- Spring Boot 集成 swagger --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.spring4all<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>swagger-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.9.0.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<ol start="2">
<li>yml配置</li>
</ol>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">swagger:</span><br>  <span class="hljs-attr">title:</span> <span class="hljs-string">&quot;学成在线内容管理系统&quot;</span><br>  <span class="hljs-attr">description:</span> <span class="hljs-string">&quot;内容系统管理系统对课程相关信息进行管理&quot;</span><br>  <span class="hljs-attr">base-package:</span> <span class="hljs-string">com.xuecheng.content</span><br>  <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">version:</span> <span class="hljs-number">1.0</span><span class="hljs-number">.0</span><br></code></pre></td></tr></table></figure>

<ol start="3">
<li>启动类加 @EnableSwagger2Doc</li>
</ol>
<p>再次启动服务，工程启动起来，访问<a target="_blank" rel="noopener" href="http://localhost:63040/content/swagger-ui.html%E6%9F%A5%E7%9C%8B%E6%8E%A5%E5%8F%A3%E4%BF%A1%E6%81%AF">http://localhost:63040/content/swagger-ui.html查看接口信息</a></p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212155347584.png" srcset="/img/loading.gif" lazyload alt="image-20231212155347584"></p>
<p><strong>加一些接口说明注解</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Api(value = &quot;课程信息编辑接口&quot;,tags = &quot;课程信息编辑接口&quot;)</span><br> <span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CourseBaseInfoController</span> &#123;<br><br>  <span class="hljs-meta">@ApiOperation(&quot;课程查询接口&quot;)</span><br> <span class="hljs-meta">@PostMapping(&quot;/course/list&quot;)</span><br>  <span class="hljs-keyword">public</span> PageResult&lt;CourseBase&gt; <span class="hljs-title function_">list</span><span class="hljs-params">(PageParams pageParams, <span class="hljs-meta">@RequestBody(required=false)</span> QueryCourseParamsDto queryCourseParams)</span>&#123;<br><br>     <span class="hljs-comment">//....</span><br><br>  &#125;<br><br>&#125;<br><br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.base.model;<br><br><span class="hljs-keyword">import</span> io.swagger.annotations.ApiModelProperty;<br><span class="hljs-keyword">import</span> lombok.AllArgsConstructor;<br><span class="hljs-keyword">import</span> lombok.Data;<br><span class="hljs-keyword">import</span> lombok.NoArgsConstructor;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description</span> 分页查询通用参数</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@date</span> 2023/12/12 11:50</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-meta">@NoArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PagesParams</span> &#123;<br><br>    <span class="hljs-comment">// 当前页码</span><br>    <span class="hljs-meta">@ApiModelProperty(&quot;当前页码&quot;)</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">Long</span> <span class="hljs-variable">pageNo</span> <span class="hljs-operator">=</span> <span class="hljs-number">1L</span>;<br><br>    <span class="hljs-comment">// 每页记录数默认值</span><br>    <span class="hljs-meta">@ApiModelProperty(&quot;每页记录数默认值&quot;)</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">Long</span> <span class="hljs-variable">pageSize</span> <span class="hljs-operator">=</span> <span class="hljs-number">10L</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.content.model.dto;<br><br><span class="hljs-keyword">import</span> io.swagger.annotations.ApiModelProperty;<br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description</span> 课程查询参数Dto</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@date</span> 2023/12/12 11:53</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">QueryCourseParamsDto</span> &#123;<br><br>    <span class="hljs-comment">// 审核状态</span><br>    <span class="hljs-meta">@ApiModelProperty(&quot;审核状态&quot;)</span><br>    <span class="hljs-keyword">private</span> String auditStatus;<br>    <span class="hljs-comment">// 课程名称</span><br>    <span class="hljs-meta">@ApiModelProperty(&quot;课程名称&quot;)</span><br>    <span class="hljs-keyword">private</span> String courseName;<br>    <span class="hljs-comment">// 发布状态</span><br>    <span class="hljs-meta">@ApiModelProperty(&quot;发布状态&quot;)</span><br>    <span class="hljs-keyword">private</span> String publishStatus;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>Swagger常用注解</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Api</span>：修饰整个类，描述Controller的作用    <br><span class="hljs-meta">@ApiOperation</span>：描述一个类的一个方法，或者说一个接口    <br><span class="hljs-meta">@ApiParam</span>：单个参数描述    <br><span class="hljs-meta">@ApiModel</span>：用对象来接收参数    <br><span class="hljs-meta">@ApiModelProperty</span>：用对象接收参数时，描述对象的一个字段    <br><span class="hljs-meta">@ApiResponse</span>：HTTP响应其中<span class="hljs-number">1</span>个描述    <br><span class="hljs-meta">@ApiResponses</span>：HTTP响应整体描述    <br><span class="hljs-meta">@ApiIgnore</span>：使用该注解忽略这个API    <br><span class="hljs-meta">@ApiError</span> ：发生错误返回的信息    <br><span class="hljs-meta">@ApiImplicitParam</span>：一个请求参数    <br><span class="hljs-meta">@ApiImplicitParams</span>：多个请求参数  <br></code></pre></td></tr></table></figure>

<p>@ApiImplicitParam属性如下：</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>取值</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>paramType</td>
<td></td>
<td>查询参数类型</td>
</tr>
<tr>
<td></td>
<td>path</td>
<td>以地址的形式提交数据</td>
</tr>
<tr>
<td></td>
<td>query</td>
<td>直接跟参数完成自动映射赋值</td>
</tr>
<tr>
<td></td>
<td>body</td>
<td>以流的形式提交 仅支持POST</td>
</tr>
<tr>
<td></td>
<td>header</td>
<td>参数在request  headers 里边提交</td>
</tr>
<tr>
<td></td>
<td>form</td>
<td>以form表单的形式提交 仅支持POST</td>
</tr>
<tr>
<td>dataType</td>
<td></td>
<td>参数的数据类型 只作为标志说明，并没有实际验证</td>
</tr>
<tr>
<td></td>
<td>Long</td>
<td></td>
</tr>
<tr>
<td></td>
<td>String</td>
<td></td>
</tr>
<tr>
<td>name</td>
<td></td>
<td>接收参数名</td>
</tr>
<tr>
<td>value</td>
<td></td>
<td>接收参数的意义描述</td>
</tr>
<tr>
<td>required</td>
<td></td>
<td>参数是否必填</td>
</tr>
<tr>
<td></td>
<td>true</td>
<td>必填</td>
</tr>
<tr>
<td></td>
<td>false</td>
<td>非必填</td>
</tr>
<tr>
<td>defaultValue</td>
<td></td>
<td>默认值</td>
</tr>
</tbody></table>
<p>给接口添加假数据, 改为POST测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.content.api;<br><br><span class="hljs-keyword">import</span> com.spring4all.swagger.EnableSwagger2Doc;<br><span class="hljs-keyword">import</span> com.xuecheng.base.model.PageResult;<br><span class="hljs-keyword">import</span> com.xuecheng.base.model.PagesParams;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.dto.QueryCourseParamsDto;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.po.CourseBase;<br><span class="hljs-keyword">import</span> io.swagger.annotations.Api;<br><span class="hljs-keyword">import</span> io.swagger.annotations.ApiOperation;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PostMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestBody;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-keyword">import</span> java.time.LocalDateTime;<br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description</span> 课程信息编辑接口</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@date</span> 2023/12/12 12:10</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@EnableSwagger2Doc</span><br><span class="hljs-meta">@Api(tags = &quot;课程信息编辑接口&quot;, value = &quot;课程信息编辑接口&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CourseBaseInfoController</span> &#123;<br><br>    <span class="hljs-meta">@ApiOperation(&quot;课程查询接口&quot;)</span><br>    <span class="hljs-meta">@PostMapping(&quot;/course/list&quot;)</span><br>    <span class="hljs-keyword">public</span> PageResult&lt;CourseBase&gt; <span class="hljs-title function_">list</span><span class="hljs-params">(PagesParams pagesParams,</span><br><span class="hljs-params">                                       <span class="hljs-meta">@RequestBody(required = false)</span> QueryCourseParamsDto queryCourseParams)</span>&#123;<br>        <span class="hljs-type">CourseBase</span> <span class="hljs-variable">courseBase</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CourseBase</span>();<br>        courseBase.setName(<span class="hljs-string">&quot;测试名称&quot;</span>);<br>        courseBase.setCreateDate(LocalDateTime.now());<br>        List&lt;CourseBase&gt; courseBases = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        courseBases.add(courseBase);<br>        PageResult&lt;CourseBase&gt; pageResult = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PageResult</span>&lt;&gt;(courseBases, <span class="hljs-number">10</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>);<br>        <span class="hljs-keyword">return</span> pageResult;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212155724678.png" srcset="/img/loading.gif" lazyload alt="image-20231212155724161"></p>
<p>这里日期的数据转了json返回给前台, 需要回到 <code>年月日时分秒	</code></p>
<p><strong>修改日期格式</strong></p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212155804817.png" srcset="/img/loading.gif" lazyload alt="image-20231212155804817"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.base.config;<br><br><span class="hljs-keyword">import</span> com.fasterxml.jackson.datatype.jsr310.deser.LocalDateTimeDeserializer;<br><span class="hljs-keyword">import</span> com.fasterxml.jackson.datatype.jsr310.ser.LocalDateTimeSerializer;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.jackson.Jackson2ObjectMapperBuilderCustomizer;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><br><span class="hljs-keyword">import</span> java.time.LocalDateTime;<br><span class="hljs-keyword">import</span> java.time.format.DateTimeFormatter;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LocalDateTimeConfig</span> &#123;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">     * 序列化内容</span><br><span class="hljs-comment">     *   LocalDateTime -&gt; String</span><br><span class="hljs-comment">     * 服务端返回给客户端内容</span><br><span class="hljs-comment">     * */</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> LocalDateTimeSerializer <span class="hljs-title function_">localDateTimeSerializer</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LocalDateTimeSerializer</span>(DateTimeFormatter.ofPattern(<span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>));<br>    &#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">     * 反序列化内容</span><br><span class="hljs-comment">     *   String -&gt; LocalDateTime</span><br><span class="hljs-comment">     * 客户端传入服务端数据</span><br><span class="hljs-comment">     * */</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> LocalDateTimeDeserializer <span class="hljs-title function_">localDateTimeDeserializer</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LocalDateTimeDeserializer</span>(DateTimeFormatter.ofPattern(<span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>));<br>    &#125;<br><br><br>    <span class="hljs-comment">// 配置</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> Jackson2ObjectMapperBuilderCustomizer <span class="hljs-title function_">jackson2ObjectMapperBuilderCustomizer</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> builder -&gt; &#123;<br>            builder.serializerByType(LocalDateTime.class, localDateTimeSerializer());<br>            builder.deserializerByType(LocalDateTime.class, localDateTimeDeserializer());<br>        &#125;;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>面试: </p>
<ol>
<li>springboot 接口开发常用注解有哪些?</li>
</ol>
<p>@Controller 标记此类是控制器, 可以返回视图解析器指定的<code>html页面</code>, 通过@ResponseBody可以将结果返回json xml数据, </p>
<p>@RestController 相当于 @ResponseBody 加 @Controller, 实现rest接口开发, 返回<code>json数据</code>, 不能返回html页面.</p>
<p>@RequestMapping 定义接口地址, 可以标注在<code>类</code>上也可以标注在<code>方法</code>上, 支持http的post get put等方法</p>
<p>@PostMapping 定义post接口, 只能标记在<code>方法</code>上, 用于添加记录, 复杂条件的查询接口</p>
<p>@GetMapping 定义get接口, 只能标记在方法上, 用于查询接口的定义</p>
<p>@PutMapping 定义 put接口, 只能标记在方法上， 用于修改接口的定义</p>
<p>@DeleteMapping定义delete接口, 只能标记在方法上, 用于删除接口的定义</p>
<p>@RequestBody 定义在方法上， 用于将<code>json串转换成java对象</code></p>
<p>@PathVarible 接收请求路径中占位符的值</p>
<p>@ApiOperation swagger注解, 对接口方法进行说明</p>
<p>@Api swagger注解, 对接口类进行说明</p>
<p>@Autowired 基于类型注入</p>
<p>@Resource 基于名称注入, 如果基于名称注入失败转为基于类型注入</p>
<ol start="2">
<li><p>项目开发流程是什么?</p>
</li>
<li><p>产品人员设计<code>产品原型</code></p>
</li>
<li><p>讨论<code>需求</code></p>
</li>
<li><p>分模块<code>设计接口</code></p>
</li>
<li><p>出<code>接口文档</code></p>
</li>
<li><p>将<code>接口文档给前端人员</code>, 前后端分离开发</p>
</li>
<li><p>开发完毕进行<code>测试</code></p>
</li>
<li><p>测试完毕发布项目, 由<code>运维人员</code>进行部署安装</p>
</li>
</ol>
</blockquote>
<h4 id="开发持久层"><a href="#开发持久层" class="headerlink" title="开发持久层"></a>开发持久层</h4><p><strong>生成mapper</strong></p>
<p>将genenator生成的mapper文件导入</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212175600088.png" srcset="/img/loading.gif" lazyload alt="image-20231212175600088"></p>
<p>mapper扫描配置和分页插件配置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.content.config;<br><br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.annotation.DbType;<br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;<br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.extension.plugins.inner.PaginationInnerInterceptor;<br><span class="hljs-keyword">import</span> org.mybatis.spring.annotation.MapperScan;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description</span> Mybatis-Plus 配置</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@date</span> 2023/12/12 17:01</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@MapperScan(&quot;com.xuecheng.content.mapper&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MybatisPlusConfig</span> &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 定义分页拦截器</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> MybatisPlusInterceptor <span class="hljs-title function_">mybatisPlusInterceptor</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">MybatisPlusInterceptor</span> <span class="hljs-variable">interceptor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MybatisPlusInterceptor</span>();<br>        interceptor.addInnerInterceptor(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PaginationInnerInterceptor</span>(DbType.MYSQL));<br>        <span class="hljs-keyword">return</span> interceptor;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>分页插件的原理: </p>
<ol>
<li>分页参数放到ThreadLocal 中, 拦截执行的sql, 根据数据库类型添加对应的分页语句重写sql ( select count(*) from table where a )  -&gt; (  select * from table where a limit   x,y    )</li>
<li>计算total总条数, records当前页数据</li>
</ol>
</blockquote>
<p>把yml和application文件复制到test</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212181131393.png" srcset="/img/loading.gif" lazyload alt="image-20231212181131393"></p>
<p>测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.content;<br><br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;<br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;<br><span class="hljs-keyword">import</span> com.xuecheng.base.model.PageResult;<br><span class="hljs-keyword">import</span> com.xuecheng.base.model.PagesParams;<br><span class="hljs-keyword">import</span> com.xuecheng.content.mapper.CourseBaseMapper;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.dto.QueryCourseParamsDto;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.po.CourseBase;<br><span class="hljs-keyword">import</span> org.apache.commons.lang.StringUtils;<br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Assertions;<br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description</span> xxx</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@date</span> 2023/12/12 17:04</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CourseBaseMapperTests</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    CourseBaseMapper courseBaseMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testCourseBaseMapper</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">CourseBase</span> <span class="hljs-variable">courseBase</span> <span class="hljs-operator">=</span> courseBaseMapper.selectById(<span class="hljs-number">18</span>);<br>        Assertions.assertNotNull(courseBase); <span class="hljs-comment">// 用断言方式确定数据是否为空</span><br><br>        <span class="hljs-comment">// 详细进行分页查询的单元测试</span><br>        <span class="hljs-comment">// 查询条件</span><br>        <span class="hljs-type">QueryCourseParamsDto</span> <span class="hljs-variable">courseParamsDto</span> <span class="hljs-operator">=</span> QueryCourseParamsDto.builder()<br>                .courseName(<span class="hljs-string">&quot;java&quot;</span>)<br>                .auditStatus(<span class="hljs-string">&quot;202004&quot;</span>)<br>                .publishStatus(<span class="hljs-string">&quot;203001&quot;</span>)<br>                .build();<br><br>        <span class="hljs-comment">// 拼装查询条件</span><br>        LambdaQueryWrapper&lt;CourseBase&gt; queryWrapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LambdaQueryWrapper</span>&lt;&gt;();<br>        <span class="hljs-comment">// 根据名称模糊查询 name like &#x27;%名称%&#x27;</span><br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">courseParamsDtoNotEmpty</span> <span class="hljs-operator">=</span> StringUtils.isNotEmpty(courseParamsDto.getCourseName());<br>        queryWrapper.like(courseParamsDtoNotEmpty, CourseBase::getName, courseParamsDto.getCourseName());<br><br>        <span class="hljs-comment">// 根据课程审核状态</span><br>        queryWrapper.eq(StringUtils.isNotEmpty(courseParamsDto.getAuditStatus()), CourseBase::getAuditStatus,<br>                courseParamsDto.getAuditStatus());<br><br>        <span class="hljs-comment">// 根据课程发布状态</span><br>        queryWrapper.eq(StringUtils.isNotEmpty(courseParamsDto.getPublishStatus()), CourseBase::getStatus,<br>                courseParamsDto.getPublishStatus());<br><br>        <span class="hljs-comment">// 创建page分页参数对象</span><br>        <span class="hljs-type">PagesParams</span> <span class="hljs-variable">pagesParams</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PagesParams</span>();<br>        pagesParams.setPageNo(<span class="hljs-number">1L</span>); <span class="hljs-comment">// 页码</span><br>        pagesParams.setPageSize(<span class="hljs-number">2L</span>); <span class="hljs-comment">// 每页记录数</span><br>        Page&lt;CourseBase&gt; page = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Page</span>&lt;&gt;(pagesParams.getPageNo(), pagesParams.getPageSize());<br><br>        <span class="hljs-comment">// 分页查询 E page 分页参数, @Param(&quot;ew&quot;) Wrapper&lt;T&gt; queryWrapper 查询条件</span><br>        Page&lt;CourseBase&gt; pageResult = courseBaseMapper.selectPage(page, queryWrapper);<br><br>        <span class="hljs-comment">// 数据</span><br>        List&lt;CourseBase&gt; items = pageResult.getRecords();<br>        <span class="hljs-comment">// 总记录数</span><br>        <span class="hljs-type">long</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> pageResult.getTotal();<br>        <span class="hljs-comment">// 准备返回数据 List&lt;T&gt; items, long counts, long page, long pageSize</span><br>        PageResult&lt;CourseBase&gt; courseBasePageResult = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PageResult</span>&lt;&gt;(items, total, pagesParams.getPageNo(),<br>                pagesParams.getPageSize());<br><br>        System.out.println(JSON.toJSONString(courseBasePageResult));<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h4 id="开发业务层"><a href="#开发业务层" class="headerlink" title="开发业务层"></a>开发业务层</h4><p>创建数据字典表, 课程基本信息查询的主要数据来源是课程基本信息表,</p>
<p><strong>创建数据字典表</strong></p>
<p>课程基本信息查询主要数据来源是<code>课程基本信息表</code>, 这里有一个点, 课程的<code>审查状态</code>, <code>发布状态</code></p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212210013694.png" srcset="/img/loading.gif" lazyload alt="image-20231212210013694"></p>
<p>这里状态存的是数字, 然后我们有一个字典表, 对应不同的状态</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212210110700.png" srcset="/img/loading.gif" lazyload alt="image-20231212210110700"></p>
<blockquote>
<p>所以为什么不存字符串, 而是加一个中间code;  如果客户需要改desc的内容, 我们不能修改内容表, 而是修改字典表, 这样避免修改用户数据的风险</p>
</blockquote>
<p>编写service</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.content.service;<br><br><span class="hljs-keyword">import</span> com.xuecheng.base.model.PageResult;<br><span class="hljs-keyword">import</span> com.xuecheng.base.model.PagesParams;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.dto.QueryCourseParamsDto;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.po.CourseBase;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 课程信息管理接口</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建 2023/12/12 20:08</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">CourseBaseInfoService</span> &#123;<br>    <span class="hljs-comment">// 课程分页查询</span><br>    PageResult&lt;CourseBase&gt; <span class="hljs-title function_">queryCourseBaseList</span><span class="hljs-params">(PagesParams pagesParams, QueryCourseParamsDto courseParamsDto)</span>;<br>    <br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.content.service.impl;<br><br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;<br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;<br><span class="hljs-keyword">import</span> com.xuecheng.base.model.PageResult;<br><span class="hljs-keyword">import</span> com.xuecheng.base.model.PagesParams;<br><span class="hljs-keyword">import</span> com.xuecheng.content.mapper.CourseBaseMapper;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.dto.QueryCourseParamsDto;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.po.CourseBase;<br><span class="hljs-keyword">import</span> com.xuecheng.content.service.CourseBaseInfoService;<br><span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;<br><span class="hljs-keyword">import</span> org.apache.commons.lang.StringUtils;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建 2023/12/12 20:11</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CourseBaseInfoServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">CourseBaseInfoService</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    CourseBaseMapper courseBaseMapper;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> PageResult&lt;CourseBase&gt; <span class="hljs-title function_">queryCourseBaseList</span><span class="hljs-params">(PagesParams pagesParams, QueryCourseParamsDto courseParamsDto)</span> &#123;<br><br>        <span class="hljs-comment">// 拼装查询条件</span><br>        LambdaQueryWrapper&lt;CourseBase&gt; queryWrapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LambdaQueryWrapper</span>&lt;&gt;();<br>        <span class="hljs-comment">// 根据名称模糊查询 name like &#x27;%名称%&#x27;</span><br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">courseParamsDtoNotEmpty</span> <span class="hljs-operator">=</span> StringUtils.isNotEmpty(courseParamsDto.getCourseName());<br>        queryWrapper.like(courseParamsDtoNotEmpty, CourseBase::getName, courseParamsDto.getCourseName());<br><br>        <span class="hljs-comment">// 根据课程审核状态</span><br>        queryWrapper.eq(StringUtils.isNotEmpty(courseParamsDto.getAuditStatus()), CourseBase::getAuditStatus,<br>                courseParamsDto.getAuditStatus());<br><br>        <span class="hljs-comment">// 根据课程发布状态</span><br>        queryWrapper.eq(StringUtils.isNotEmpty(courseParamsDto.getPublishStatus()), CourseBase::getStatus,<br>                courseParamsDto.getPublishStatus());<br><br>        Page&lt;CourseBase&gt; page = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Page</span>&lt;&gt;(pagesParams.getPageNo(), pagesParams.getPageSize());<br><br>        <span class="hljs-comment">// 分页查询 E page 分页参数, @Param(&quot;ew&quot;) Wrapper&lt;T&gt; queryWrapper 查询条件</span><br>        Page&lt;CourseBase&gt; pageResult = courseBaseMapper.selectPage(page, queryWrapper);<br><br>        <span class="hljs-comment">// 数据</span><br>        List&lt;CourseBase&gt; items = pageResult.getRecords();<br>        <span class="hljs-comment">// 总记录数</span><br>        <span class="hljs-type">long</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> pageResult.getTotal();<br>        <span class="hljs-comment">// 准备返回数据 List&lt;T&gt; items, long counts, long page, long pageSize</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PageResult</span>&lt;&gt;(items, total, pagesParams.getPageNo(),<br>                pagesParams.getPageSize());<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>对service进行单元测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.content;<br><br><span class="hljs-keyword">import</span> com.xuecheng.base.model.PageResult;<br><span class="hljs-keyword">import</span> com.xuecheng.base.model.PagesParams;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.dto.QueryCourseParamsDto;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.po.CourseBase;<br><span class="hljs-keyword">import</span> com.xuecheng.content.service.CourseBaseInfoService;<br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description</span> xxx</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@date</span> 2023/12/12 17:04</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CourseBaseInfoServiceTests</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    CourseBaseInfoService courseBaseInfoService;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testCourseBaseInfoService</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">// 详细进行分页查询的单元测试</span><br>        <span class="hljs-comment">// 查询条件</span><br>        <span class="hljs-type">QueryCourseParamsDto</span> <span class="hljs-variable">courseParamsDto</span> <span class="hljs-operator">=</span> QueryCourseParamsDto.builder()<br>                .courseName(<span class="hljs-string">&quot;java&quot;</span>)<br>                .auditStatus(<span class="hljs-string">&quot;202004&quot;</span>)<br>                .publishStatus(<span class="hljs-string">&quot;203001&quot;</span>)<br>                .build();<br>        <span class="hljs-comment">// 创建page分页参数对象</span><br>        <span class="hljs-type">PagesParams</span> <span class="hljs-variable">pagesParams</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PagesParams</span>();<br>        pagesParams.setPageNo(<span class="hljs-number">1L</span>); <span class="hljs-comment">// 页码</span><br>        pagesParams.setPageSize(<span class="hljs-number">2L</span>); <span class="hljs-comment">// 每页记录数</span><br>        PageResult&lt;CourseBase&gt; courseBasePageResult =<br>                courseBaseInfoService.queryCourseBaseList(pagesParams, courseParamsDto);<br>        System.out.println(courseBasePageResult);<br>    &#125;<br><br><br><br><br><br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="接口测试"><a href="#接口测试" class="headerlink" title="接口测试"></a>接口测试</h4><p>编写controller</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.content.api;<br><br><span class="hljs-keyword">import</span> com.spring4all.swagger.EnableSwagger2Doc;<br><span class="hljs-keyword">import</span> com.xuecheng.base.model.PageResult;<br><span class="hljs-keyword">import</span> com.xuecheng.base.model.PagesParams;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.dto.QueryCourseParamsDto;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.po.CourseBase;<br><span class="hljs-keyword">import</span> com.xuecheng.content.service.CourseBaseInfoService;<br><span class="hljs-keyword">import</span> io.swagger.annotations.Api;<br><span class="hljs-keyword">import</span> io.swagger.annotations.ApiOperation;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PostMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestBody;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description</span> 课程信息编辑接口</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@date</span> 2023/12/12 12:10</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@EnableSwagger2Doc</span><br><span class="hljs-meta">@Api(tags = &quot;课程信息编辑接口&quot;, value = &quot;课程信息编辑接口&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CourseBaseInfoController</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    CourseBaseInfoService courseBaseInfoService;<br><br>    <span class="hljs-meta">@ApiOperation(&quot;课程查询接口&quot;)</span><br>    <span class="hljs-meta">@PostMapping(&quot;/course/list&quot;)</span><br>    <span class="hljs-keyword">public</span> PageResult&lt;CourseBase&gt; <span class="hljs-title function_">list</span><span class="hljs-params">(PagesParams pagesParams,</span><br><span class="hljs-params">                                       <span class="hljs-meta">@RequestBody</span> QueryCourseParamsDto queryCourseParams)</span>&#123;<br>        <span class="hljs-keyword">return</span> courseBaseInfoService.queryCourseBaseList(pagesParams, queryCourseParams);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>swagger测试</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212210652261.png" srcset="/img/loading.gif" lazyload alt="image-20231212210652261"></p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212210658181.png" srcset="/img/loading.gif" lazyload alt="image-20231212210658181"></p>
<p>httpclient测试</p>
<p>将.http文件按模块和主机地址配置文件单独存放</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212210916532.png" srcset="/img/loading.gif" lazyload alt="image-20231212210916532"></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;dev&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;access_token&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;gateway_host&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;localhost:63010&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;content_host&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;localhost:63040&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;system_host&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;localhost:63110&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;media_host&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;localhost:63050&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;search_host&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;localhost:63080&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;auth_host&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;localhost:63070&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;checkcode_host&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;localhost:63075&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;learning_host&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;localhost:63020&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs http">### 课程查询列表<br>POST &#123;&#123;content_host&#125;&#125;/content/course/list?pageParams=1&amp;pageSize=2<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json<br><br>&#123;<br>  &quot;auditStatus&quot;: &quot;&quot;,<br>  &quot;courseName&quot;: &quot;java&quot;,<br>  &quot;publishStatus&quot;: &quot;&quot;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="前后端联调"><a href="#前后端联调" class="headerlink" title="前后端联调"></a>前后端联调</h4><blockquote>
<p>后端编写文档, 文档给前端, 前后端并行开发, 前端mock假数据, 后端接口联调, 前端将mock数据改为请求后端的接口, 前端请求后端测试接口是否正常</p>
</blockquote>
<p>用IDEA打开vue工程, 出错</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">npm install -g cnpm <span class="hljs-attribute">--registry</span>=https://registry.npm.taobao.org<br>cnpm i<br>npm <span class="hljs-built_in">run</span> serve<br></code></pre></td></tr></table></figure>



<p>后端开启跨域(关于跨域问题, 总结在单独的文章)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.system.config;<br><br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.web.cors.CorsConfiguration;<br><span class="hljs-keyword">import</span> org.springframework.web.cors.UrlBasedCorsConfigurationSource;<br><span class="hljs-keyword">import</span> org.springframework.web.filter.CorsFilter;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description</span> 跨域过虑器</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> Mr.M</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@date</span> 2022/9/7 11:04</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0</span><br><span class="hljs-comment"> */</span><br> <span class="hljs-meta">@Configuration</span><br> <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GlobalCorsConfig</span> &#123;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * 允许跨域调用的过滤器</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-meta">@Bean</span><br>  <span class="hljs-keyword">public</span> CorsFilter <span class="hljs-title function_">corsFilter</span><span class="hljs-params">()</span> &#123;<br>   <span class="hljs-type">CorsConfiguration</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CorsConfiguration</span>();<br>   <span class="hljs-comment">//允许白名单域名进行跨域调用</span><br>   config.addAllowedOrigin(<span class="hljs-string">&quot;*&quot;</span>);<br>   <span class="hljs-comment">//允许跨越发送cookie</span><br>   config.setAllowCredentials(<span class="hljs-literal">true</span>);<br>   <span class="hljs-comment">//放行全部原始头信息</span><br>   config.addAllowedHeader(<span class="hljs-string">&quot;*&quot;</span>);<br>   <span class="hljs-comment">//允许所有请求方法跨域调用</span><br>   config.addAllowedMethod(<span class="hljs-string">&quot;*&quot;</span>);<br>   <span class="hljs-type">UrlBasedCorsConfigurationSource</span> <span class="hljs-variable">source</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UrlBasedCorsConfigurationSource</span>();<br>   source.registerCorsConfiguration(<span class="hljs-string">&quot;/**&quot;</span>, config);<br>   <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CorsFilter</span>(source);<br>  &#125;<br> &#125;<br><br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://localhost:63110/system/dictionary/all">http://localhost:63110/system/dictionary/all</a></p>
<p><a target="_blank" rel="noopener" href="http://localhost:8601/">http://localhost:8601</a></p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231212221419802.png" srcset="/img/loading.gif" lazyload alt="image-20231212221419802"></p>
<h3 id="课程分类查询"><a href="#课程分类查询" class="headerlink" title="课程分类查询"></a>课程分类查询</h3><h4 id="需求分析-1"><a href="#需求分析-1" class="headerlink" title="需求分析"></a>需求分析</h4><p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213154939950.png" srcset="/img/loading.gif" lazyload alt="image-20231213154939950"></p>
<p>这3个课程等级和课程类型来源于数据字典表, 在系统管理服务读取, 而课程分类信息单独一张课程分类表, 存储在内容管理数据库中</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213155131812.png" srcset="/img/loading.gif" lazyload alt="image-20231213155131812"></p>
<p>这张表是一个树形表, 通过父节点id将各元素组成一个树</p>
<p>需求: 在内容管理服务中编写一个接口读取课程分类表的数据, 组成一个<code>树形结构</code>给前端</p>
<p>这个树形结构数据: </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br></pre></td><td class="code"><pre><code class="hljs json">JSON<br> <span class="hljs-punctuation">[</span><br>         <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>               <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1-1&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;HTML/CSS&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;HTML/CSS&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1&quot;</span><br>               <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1-2&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;JavaScript&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;JavaScript&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1&quot;</span><br>               <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1-3&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;jQuery&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;jQuery&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1&quot;</span><br>               <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1-4&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ExtJS&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ExtJS&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1&quot;</span><br>               <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1-5&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;AngularJS&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;AngularJS&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1&quot;</span><br>               <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1-6&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ReactJS&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ReactJS&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">6</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1&quot;</span><br>               <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1-7&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Bootstrap&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Bootstrap&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">7</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1&quot;</span><br>               <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1-8&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Node.js&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Node.js&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">8</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1&quot;</span><br>               <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1-9&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Vue&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Vue&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1&quot;</span><br>               <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1-10&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;其它&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;其它&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1&quot;</span><br>               <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;前端开发&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;前端开发&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1&quot;</span><br>         <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>               <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-2-1&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;微信开发&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;微信开发&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-2&quot;</span><br>               <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-2-2&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;iOS&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;iOS&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-2&quot;</span><br>               <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-2-3&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;手游开发&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;手游开发&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-2&quot;</span><br>               <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-2-4&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Swift&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Swift&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-2&quot;</span><br>               <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-2-5&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Android&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Android&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-2&quot;</span><br>               <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-2-6&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ReactNative&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ReactNative&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">6</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-2&quot;</span><br>               <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-2-7&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Cordova&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Cordova&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">7</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-2&quot;</span><br>               <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;childrenTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-2-8&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;其它&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;其它&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">8</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-2&quot;</span><br>               <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-2&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;isLeaf&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;isShow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;label&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;移动开发&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;移动开发&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1&quot;</span><br>         <span class="hljs-punctuation">&#125;</span><br>   <span class="hljs-punctuation">]</span><br><br></code></pre></td></tr></table></figure>

<h4 id="DTO"><a href="#DTO" class="headerlink" title="DTO"></a>DTO</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.content.model.dto;<br><br><span class="hljs-keyword">import</span> com.xuecheng.content.model.po.CourseCategory;<br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-keyword">import</span> java.io.Serializable;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Serializable 将来网络传输需要序列化</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建 2023/12/13 10:21</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CourseCategoryTreeDto</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">CourseCategory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> &#123;<br>    List&lt;CourseCategoryTreeDto&gt;  childrenTreeNodes;<br>    <br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="controller"><a href="#controller" class="headerlink" title="controller"></a>controller</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.content.api;<br><br><span class="hljs-keyword">import</span> com.xuecheng.content.model.dto.CourseCategoryTreeDto;<br><span class="hljs-keyword">import</span> com.xuecheng.content.service.CourseCategoryService;<br><span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 数据字典， 前端控制器</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建 2023/12/13 10:50</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CourseCategoryController</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    CourseCategoryService courseCategoryService;<br><br>    <span class="hljs-comment">// 树级节点问题</span><br>    <span class="hljs-meta">@GetMapping(&quot;/course-category/tree-nodes&quot;)</span><br>    <span class="hljs-keyword">public</span> List&lt;CourseCategoryTreeDto&gt; <span class="hljs-title function_">queryTreeNodes</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> courseCategoryService.queryTreeNodes(<span class="hljs-string">&quot;1&quot;</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="service-注意逻辑"><a href="#service-注意逻辑" class="headerlink" title="service(注意逻辑)"></a>service(注意逻辑)</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.content.service.impl;<br><br><span class="hljs-keyword">import</span> com.xuecheng.content.mapper.CourseCategoryMapper;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.dto.CourseCategoryTreeDto;<br><span class="hljs-keyword">import</span> com.xuecheng.content.service.CourseCategoryService;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Map;<br><span class="hljs-keyword">import</span> java.util.stream.Collectors;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建 2023/12/13 11:47</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CourseCategoryServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">CourseCategoryService</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    CourseCategoryMapper courseCategoryMapper;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> List&lt;CourseCategoryTreeDto&gt; <span class="hljs-title function_">queryTreeNodes</span><span class="hljs-params">(String id)</span> &#123;<br>        <span class="hljs-comment">// 调用mapper递归查询分类信息</span><br>        List&lt;CourseCategoryTreeDto&gt; courseCategoryTreeDtos = courseCategoryMapper.selectTreeNodes(id);<br><br>        <span class="hljs-comment">// 找到每个节点的子节点, 最终封装成List&lt;CourseCategoryTreeDto&gt;</span><br>        <span class="hljs-comment">// 将List转Map, key是节点的id, value是CourseCategoryTreeDto对象, 目的是为了方便从map获取节点</span><br>        Map&lt;String, CourseCategoryTreeDto&gt; mapTemp = courseCategoryTreeDtos.stream()<br>                <span class="hljs-comment">// filter排除根节点(id = 1)</span><br>                .filter(item-&gt;!id.equals(item.getId()))<br>                <span class="hljs-comment">//  key是list中元素的id, value不变, 如果key1和key2在遍历时发生重复, 我们用后面的key2</span><br>                .collect(Collectors.toMap(key -&gt; key.getId(), value -&gt; value, (key1, key2) -&gt; key2));<br><br>        <span class="hljs-comment">// 定义一个list, 用于最终返回</span><br>        List&lt;CourseCategoryTreeDto&gt; courseCategoryList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-comment">// 从头遍历list,filter排除根节点(id = 1), 一边遍历一边找子节点放在父节点的childrenTreeNodes</span><br>        courseCategoryTreeDtos.stream()<br>                .filter(item-&gt;!id.equals(item.getId()))<br>                .forEach(item-&gt;&#123;<br>                    <span class="hljs-comment">// 结论: 假设 listTree 共三级, 一级被过滤, 如果二级则走第一个if分支, 如果三级则走第二个if分支</span><br><br>                    <span class="hljs-comment">// 放入根节点的子节点作为 返回listTree的 `一级节点`</span><br>                    <span class="hljs-keyword">if</span> (item.getParentid().equals(id))&#123;<br>                        courseCategoryList.add(item);<br>                    &#125;<br><br>                    <span class="hljs-comment">// 找到当前节点的父节点</span><br>                    <span class="hljs-type">CourseCategoryTreeDto</span> <span class="hljs-variable">courseCategoryTreeDto</span> <span class="hljs-operator">=</span> mapTemp.get(item.getParentid());<br>                    <span class="hljs-comment">// 如果map中过滤了id=1, 不为空表示这里 item 不是二级节点(id=1-1), 应该至多三级(id=1-1-1),</span><br>                    <span class="hljs-comment">// 而这个courseCategoryTreeDto就至多二级(id=1-1), 这里的Dto是已经走过第一个if分支的item,</span><br>                    <span class="hljs-comment">// 所以下面add不往courseCategoryList, 而是 Dto</span><br>                    <span class="hljs-keyword">if</span> (courseCategoryTreeDto != <span class="hljs-literal">null</span>)&#123;<br>                        <span class="hljs-keyword">if</span> (courseCategoryTreeDto.getChildrenTreeNodes() == <span class="hljs-literal">null</span>) &#123; <span class="hljs-comment">// 二级节点的ChildrenTreeNodes属性为null, 我们new</span><br>                            courseCategoryTreeDto.setChildrenTreeNodes(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;CourseCategoryTreeDto&gt;());<br>                        &#125;<br>                        <span class="hljs-comment">// 往ChildrenTreeNodes属性中放子节点</span><br>                        courseCategoryTreeDto.getChildrenTreeNodes().add(item);<br>                    &#125;<br>                &#125;);<br><br>        <span class="hljs-keyword">return</span> courseCategoryList;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="mapper"><a href="#mapper" class="headerlink" title="mapper"></a>mapper</h4><blockquote>
<p>这里mapper查法有inner join自连接, 和recursive递归两种方案, 递归更加<code>通用</code></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span><br>	one.id one_id,<br>	one.label one_label,<br>	two.id two_id,<br>	two.label two_label <br><span class="hljs-keyword">FROM</span><br>	`course_category` <span class="hljs-keyword">one</span><br>	<span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> course_category two <span class="hljs-keyword">ON</span> two.parentid <span class="hljs-operator">=</span> one.id <br><span class="hljs-keyword">WHERE</span><br>	one.parentid <span class="hljs-operator">=</span> <span class="hljs-number">1</span> <br>	<span class="hljs-keyword">AND</span> one.is_show <span class="hljs-operator">=</span> <span class="hljs-number">1</span> <br>	<span class="hljs-keyword">AND</span> two.is_show <span class="hljs-operator">=</span> <span class="hljs-number">1</span> <br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span><br>	one.orderby,<br>	two.orderby<br>	<br><span class="hljs-keyword">with</span> <span class="hljs-keyword">RECURSIVE</span> t1  <span class="hljs-keyword">AS</span><br>(<br>  <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">as</span> n<br>  <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span><br>  <span class="hljs-keyword">SELECT</span> n <span class="hljs-operator">+</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> t1 <span class="hljs-keyword">WHERE</span> n <span class="hljs-operator">&lt;</span> <span class="hljs-number">5</span><br>)<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t1;<br><br># 向下递归<br><span class="hljs-keyword">with</span> <span class="hljs-keyword">recursive</span> t1 <span class="hljs-keyword">as</span> (<br> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>  course_category p <span class="hljs-keyword">where</span>  id<span class="hljs-operator">=</span> <span class="hljs-string">&#x27;1&#x27;</span><br> <span class="hljs-keyword">union</span> <span class="hljs-keyword">all</span><br> <span class="hljs-keyword">select</span> t.<span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> course_category t <span class="hljs-keyword">inner</span> <span class="hljs-keyword">join</span> t1 <span class="hljs-keyword">on</span> t1.id <span class="hljs-operator">=</span> t.parentid<br>)<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span>  <span class="hljs-keyword">from</span> t1 <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> t1.id, t1.orderby<br><br># 向上递归<br><span class="hljs-keyword">with</span> <span class="hljs-keyword">recursive</span> t1 <span class="hljs-keyword">as</span> (<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>  course_category p <span class="hljs-keyword">where</span>  id<span class="hljs-operator">=</span> <span class="hljs-string">&#x27;1-1-1&#x27;</span><br><span class="hljs-keyword">union</span> <span class="hljs-keyword">all</span><br> <span class="hljs-keyword">select</span> t.<span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> course_category t <span class="hljs-keyword">inner</span> <span class="hljs-keyword">join</span> t1 <span class="hljs-keyword">on</span> t1.parentid <span class="hljs-operator">=</span> t.id<br>)<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span>  <span class="hljs-keyword">from</span> t1 <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> t1.id, t1.orderby<br></code></pre></td></tr></table></figure>

<p>我们采用<code>递归</code>方式</p>
<p>mysql避免无限递归默认递归次数1000, 通过参数增加递归深度, 限制递归时间</p>
<p>相当于存储过程执行若干sql语句, java与数据库建立一次链接执行递归操作, 只要控制好递归深度, 性能没有问题</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.content.mapper;<br><br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.core.mapper.BaseMapper;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.dto.CourseCategoryTreeDto;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.po.CourseCategory;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 课程分类 Mapper 接口</span><br><span class="hljs-comment"> * &lt;/p&gt;</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> itcast</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">CourseCategoryMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;CourseCategory&gt; &#123;<br>    List&lt;CourseCategoryTreeDto&gt; <span class="hljs-title function_">selectTreeNodes</span><span class="hljs-params">(String id)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectTreeNodes&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.xuecheng.content.model.dto.CourseCategoryTreeDto&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;java.lang.String&quot;</span>&gt;</span><br>    with recursive t1 as (<br>        select * from  course_category p where  id= #&#123;id&#125;<br>        union all<br>        select t.* from course_category t inner join t1 on t1.id = t.parentid<br>    )<br>    select *  from t1 order by t1.id, t1.orderby<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="测试service"><a href="#测试service" class="headerlink" title="测试service"></a>测试service</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.content;<br><br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.dto.CourseCategoryTreeDto;<br><span class="hljs-keyword">import</span> com.xuecheng.content.service.CourseCategoryService;<br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建 2023/12/13 16:00</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CourseCategoryServiceTests</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    CourseCategoryService courseCategoryService;<br><br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>&#123;<br>        List&lt;CourseCategoryTreeDto&gt; courseCategoryTreeDtos = courseCategoryService.queryTreeNodes(<span class="hljs-string">&quot;1&quot;</span>);<br>        System.out.println(JSON.toJSONString(courseCategoryTreeDtos));<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="测试接口"><a href="#测试接口" class="headerlink" title="测试接口"></a>测试接口</h4><p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213165458999.png" srcset="/img/loading.gif" lazyload alt="image-20231213165458999"></p>
<h4 id="前后端联调-1"><a href="#前后端联调-1" class="headerlink" title="前后端联调"></a>前后端联调</h4><p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213165734568.png" srcset="/img/loading.gif" lazyload alt="image-20231213165734568"></p>
<h3 id="新增课程"><a href="#新增课程" class="headerlink" title="新增课程"></a>新增课程</h3><h4 id="需求分析-2"><a href="#需求分析-2" class="headerlink" title="需求分析"></a>需求分析</h4><p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213165812252.png" srcset="/img/loading.gif" lazyload alt="image-20231213165812252"></p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213165825088.png" srcset="/img/loading.gif" lazyload alt="image-20231213165825088"></p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213165907293.png" srcset="/img/loading.gif" lazyload alt="image-20231213165907293"></p>
<p>在表单填入课程基本信息, 下一步</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213170043851.png" srcset="/img/loading.gif" lazyload alt="image-20231213170043851"></p>
<p>添加章节, 上传视频,下一步</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213170138973.png" srcset="/img/loading.gif" lazyload alt="image-20231213170138973"></p>
<p>维护老师, 可以添加老师</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213170214715.png" srcset="/img/loading.gif" lazyload alt="image-20231213170214715"></p>
<p>完成</p>
<h4 id="数据模型"><a href="#数据模型" class="headerlink" title="数据模型"></a>数据模型</h4><p>新增课程按钮, 向课程基本信息, 课程营销信息添加记录(course_base   course_market)</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213170510366.png" srcset="/img/loading.gif" lazyload alt="image-20231213170510366"></p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213170517609.png" srcset="/img/loading.gif" lazyload alt="image-20231213170517609"></p>
<h4 id="接口定义"><a href="#接口定义" class="headerlink" title="接口定义"></a>接口定义</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs json">Java<br>### 创建课程<br>POST <span class="hljs-punctuation">&#123;</span><span class="hljs-punctuation">&#123;</span>content_host<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span>/content/course<br>Content-Type<span class="hljs-punctuation">:</span> application/json<br><br><span class="hljs-punctuation">&#123;</span><br><br>  <span class="hljs-attr">&quot;mt&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;st&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;pic&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;teachmode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;200002&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;users&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;初级人员&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;tags&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;grade&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;204001&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;charge&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;201000&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;price&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;originalPrice&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;qq&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;wechat&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;phone&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;validDays&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">365</span><br><span class="hljs-punctuation">&#125;</span><br><br>###响应结果如下<br>#成功响应结果如下<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">109</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;companyId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;companyName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;测试课程103&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;users&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;初级人员&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;tags&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;mt&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;mtName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;st&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1-1-1&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;stName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;grade&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;204001&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;teachmode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;200002&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;pic&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;createDate&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2022-09-08 07:35:16&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;changeDate&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;createPeople&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;changePeople&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;auditStatus&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;202002&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;coursePubId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;coursePubDate&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;charge&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;201000&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;price&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;originalPrice&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;qq&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;wechat&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;phone&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;validDays&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">365</span><br><span class="hljs-punctuation">&#125;</span><br><br></code></pre></td></tr></table></figure>

<h4 id="controller-1"><a href="#controller-1" class="headerlink" title="controller"></a>controller</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ApiOperation(&quot;新增课程基础信息&quot;)</span><br><span class="hljs-meta">@PostMapping(&quot;/course&quot;)</span><br><span class="hljs-keyword">public</span> CourseBaseInfoDto <span class="hljs-title function_">createCourseBase</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> AddCourseDto addCourseDto)</span>&#123;<br>    <span class="hljs-comment">// 机构id, 由于认证系统没有上限暂时硬编码</span><br>    <span class="hljs-type">Long</span> <span class="hljs-variable">companyId</span> <span class="hljs-operator">=</span> <span class="hljs-number">1232141425L</span>;<br>    <span class="hljs-keyword">return</span> courseBaseInfoService.createCourseBase(companyId, addCourseDto);<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="service"><a href="#service" class="headerlink" title="service"></a>service</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 新增课程基础信息</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> companyId</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> dto</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> CourseBaseInfoDto <span class="hljs-title function_">createCourseBase</span><span class="hljs-params">(Long companyId, AddCourseDto dto)</span> &#123;<br>    <span class="hljs-comment">// 合法性校验</span><br>    <span class="hljs-keyword">if</span> (StringUtils.isBlank(dto.getName())) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;课程名称为空&quot;</span>);<br>    <span class="hljs-keyword">if</span> (StringUtils.isBlank(dto.getMt())) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;课程分类为空&quot;</span>);<br>    <span class="hljs-keyword">if</span> (StringUtils.isBlank(dto.getSt())) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;课程名称为空&quot;</span>);<br>    <span class="hljs-keyword">if</span> (StringUtils.isBlank(dto.getGrade())) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;课程等级为空&quot;</span>);<br>    <span class="hljs-keyword">if</span> (StringUtils.isBlank(dto.getTeachmode())) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;教育模式为空&quot;</span>);<br>    <span class="hljs-keyword">if</span> (StringUtils.isBlank(dto.getUsers())) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;适应人群为空&quot;</span>);<br>    <span class="hljs-keyword">if</span> (StringUtils.isBlank(dto.getCharge())) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;收费规则为空&quot;</span>);<br><br>    <span class="hljs-comment">// 新增对象</span><br>    <span class="hljs-type">CourseBase</span> <span class="hljs-variable">courseBaseNew</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CourseBase</span>();<br>    <span class="hljs-comment">// 将课程信息赋值给新增对象</span><br>    BeanUtils.copyProperties(dto, courseBaseNew);<br>    <span class="hljs-comment">// 设置审核状态</span><br>    courseBaseNew.setAuditStatus(<span class="hljs-string">&quot;202002&quot;</span>);<br>    <span class="hljs-comment">// 设置发布状态</span><br>    courseBaseNew.setStatus(<span class="hljs-string">&quot;203001&quot;</span>);<br>    <span class="hljs-comment">// 机构id</span><br>    courseBaseNew.setCompanyId(companyId);<br>    <span class="hljs-comment">// 添加时间</span><br>    courseBaseNew.setCreateDate(LocalDateTime.now());<br>    <span class="hljs-comment">// 插入课程基本信息表</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">insert</span> <span class="hljs-operator">=</span> courseBaseMapper.insert(courseBaseNew);<br>    <span class="hljs-keyword">if</span> (insert &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;新增课程基本信息失败&quot;</span>);<br><br>    <span class="hljs-comment">// 向课程营销表保存课程营销信息</span><br>    <span class="hljs-type">CourseMarket</span> <span class="hljs-variable">courseMarketNew</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CourseMarket</span>();<br>    BeanUtils.copyProperties(dto, courseMarketNew);<br>    <span class="hljs-type">Long</span> <span class="hljs-variable">courseId</span> <span class="hljs-operator">=</span> courseBaseNew.getId();<br>    courseMarketNew.setId(courseId);<br>    <span class="hljs-comment">// 向课程营销表插入数据或更新数据</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> saveCourseMarket(courseMarketNew);<br>    <span class="hljs-keyword">if</span> (i&lt;=<span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;保存课程营销信息失败&quot;</span>);<br><br>    <span class="hljs-comment">// 查询课程基本信息及营销信息并返回</span><br>    <span class="hljs-keyword">return</span> getCourseBaseInfo(courseId);<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 查询课程基本信息及营销信息并返回</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> courseId</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">private</span> CourseBaseInfoDto <span class="hljs-title function_">getCourseBaseInfo</span><span class="hljs-params">(Long courseId)</span> &#123;<br>    <span class="hljs-type">CourseBase</span> <span class="hljs-variable">courseBase</span> <span class="hljs-operator">=</span> courseBaseMapper.selectById(courseId);<br>    <span class="hljs-keyword">if</span> (courseBase==<span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-type">CourseMarket</span> <span class="hljs-variable">courseMarket</span> <span class="hljs-operator">=</span> courseMarketMapper.selectById(courseId);<br>    <span class="hljs-type">CourseBaseInfoDto</span> <span class="hljs-variable">courseBaseInfoDto</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CourseBaseInfoDto</span>();<br>    BeanUtils.copyProperties(courseBase, courseBaseInfoDto);<br>    <span class="hljs-keyword">if</span> (courseMarket != <span class="hljs-literal">null</span>)<br>        BeanUtils.copyProperties(courseMarket, courseBaseInfoDto);<br>    <span class="hljs-comment">// 查询分类名称</span><br>    <span class="hljs-type">CourseCategory</span> <span class="hljs-variable">courseCategoryBySt</span> <span class="hljs-operator">=</span> courseCategoryMapper.selectById(courseBase.getSt());<br>    courseBaseInfoDto.setStName(courseCategoryBySt.getName());<br>    <span class="hljs-type">CourseCategory</span> <span class="hljs-variable">courseCategoryByMt</span> <span class="hljs-operator">=</span> courseCategoryMapper.selectById(courseBase.getMt());<br>    courseBaseInfoDto.setMtName(courseCategoryByMt.getName());<br><br>    <span class="hljs-keyword">return</span> courseBaseInfoDto;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 向课程营销表插入数据或更新数据</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> courseMarketNew</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">saveCourseMarket</span><span class="hljs-params">(CourseMarket courseMarketNew)</span> &#123;<br>    <span class="hljs-comment">// 收费规则</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">charge</span> <span class="hljs-operator">=</span> courseMarketNew.getCharge();<br>    <span class="hljs-type">Float</span> <span class="hljs-variable">price</span> <span class="hljs-operator">=</span> courseMarketNew.getPrice();<br>    <span class="hljs-keyword">if</span> (StringUtils.isBlank(charge)) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;收费规则没有选择&quot;</span>);<br>    <span class="hljs-comment">// 收费规则为收费</span><br>    <span class="hljs-keyword">if</span> (charge.equals(<span class="hljs-string">&quot;201001&quot;</span>)) &#123;<br>        <span class="hljs-keyword">if</span> (price == <span class="hljs-literal">null</span> || price &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;课程为收费价格不能为空且必须大于0&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// 根据id从课程营销表查询</span><br>    <span class="hljs-type">CourseMarket</span> <span class="hljs-variable">courseMarketObj</span> <span class="hljs-operator">=</span> courseMarketMapper.selectById(courseMarketNew.getId());<br>    <span class="hljs-keyword">if</span> (courseMarketObj == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> courseMarketMapper.insert(courseMarketNew);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        BeanUtils.copyProperties(courseMarketNew, courseMarketObj);<br>        courseMarketObj.setId(courseMarketNew.getId());<br>        <span class="hljs-keyword">return</span> courseMarketMapper.updateById(courseMarketObj);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="接口测试-1"><a href="#接口测试-1" class="headerlink" title="接口测试"></a>接口测试</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">### 创建课程</span><br>POST &#123;&#123;content_host&#125;&#125;/content/course<br>Content-Type: application/json<br><br>&#123;<br><br>  <span class="hljs-string">&quot;mt&quot;</span>: <span class="hljs-string">&quot;1-1&quot;</span>,<br>  <span class="hljs-string">&quot;st&quot;</span>: <span class="hljs-string">&quot;1-1-1&quot;</span>,<br>  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;java&quot;</span>,<br>  <span class="hljs-string">&quot;pic&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-string">&quot;teachmode&quot;</span>: <span class="hljs-string">&quot;200002&quot;</span>,<br>  <span class="hljs-string">&quot;users&quot;</span>: <span class="hljs-string">&quot;初级人员&quot;</span>,<br>  <span class="hljs-string">&quot;tags&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-string">&quot;grade&quot;</span>: <span class="hljs-string">&quot;204001&quot;</span>,<br>  <span class="hljs-string">&quot;description&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-string">&quot;charge&quot;</span>: <span class="hljs-string">&quot;201000&quot;</span>,<br>  <span class="hljs-string">&quot;price&quot;</span>: 0,<br>  <span class="hljs-string">&quot;originalPrice&quot;</span>:0,<br>  <span class="hljs-string">&quot;qq&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-string">&quot;wechat&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-string">&quot;phone&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-string">&quot;validDays&quot;</span>: 365<br>&#125;<br></code></pre></td></tr></table></figure>



<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213182004016.png" srcset="/img/loading.gif" lazyload alt="image-20231213182004016"></p>
<h4 id="前后端联调-2"><a href="#前后端联调-2" class="headerlink" title="前后端联调"></a>前后端联调</h4><p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213182458219.png" srcset="/img/loading.gif" lazyload alt="image-20231213182458219"></p>
<h4 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h4><p><strong>问题分析</strong></p>
<p>我们上一步把name填成空</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213182803776.png" srcset="/img/loading.gif" lazyload alt="image-20231213182803776"></p>
<p>按照合法性校验, 应该返回错误信息  <code>课程名称为空</code>, 这里返回 <code>Internal Server Error</code> 不友好</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lisp">if (<span class="hljs-name">StringUtils</span>.isBlank(<span class="hljs-name">dto</span>.getName())) throw new RuntimeException(<span class="hljs-string">&quot;课程名称为空&quot;</span>)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure>

<p>没有输出我们抛出异常指定的异常信息，我们的需求是当正常操作按接口要求返回数据，当非正常流程要获取异常信息进行记录，并提示给用户</p>
<p>异常处理除了输出日志, 还要提示给用户, 前端和后端做一些约定</p>
<ol>
<li>错误提示信息统一<code>json</code>格式返回前端</li>
<li>以HTTP状态码决定是否出错, 非200为操作异常</li>
</ol>
<p>规范异常信息?</p>
<p>代码统一抛出的是自定义异常, 需要统一<code>捕获</code>,  规范了异常类型就可以获取异常信息</p>
<p>捕获后非项目自定义异常类型统一向用户提示<code>执行过程异常, 请重试</code> 错误信息</p>
<p>如何捕获异常?</p>
<p>try&#x2F;catch 比较臃肿, 通过MVC 控制器增强类统一有一个类完成异常捕获</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213194604949.png" srcset="/img/loading.gif" lazyload alt="image-20231213194604949"></p>
<p><strong>统一异常实现</strong></p>
<p><strong>通用的异常信息</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.base.execption;<br><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description</span> 通用错误信息</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> Mr.M</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@date</span> 2022/9/6 11:29</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">CommonError</span> &#123;<br><br>    UNKOWN_ERROR(<span class="hljs-string">&quot;执行过程异常，请重试。&quot;</span>),<br>    PARAMS_ERROR(<span class="hljs-string">&quot;非法参数&quot;</span>),<br>    OBJECT_NULL(<span class="hljs-string">&quot;对象为空&quot;</span>),<br>    QUERY_NULL(<span class="hljs-string">&quot;查询结果为空&quot;</span>),<br>    REQUEST_NULL(<span class="hljs-string">&quot;请求参数为空&quot;</span>);<br><br>    <span class="hljs-keyword">private</span> String errMessage;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getErrMessage</span><span class="hljs-params">()</span> &#123;<br>       <span class="hljs-keyword">return</span> errMessage;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">CommonError</span><span class="hljs-params">( String errMessage)</span> &#123;<br>       <span class="hljs-built_in">this</span>.errMessage = errMessage;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>自定义异常类型</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.base.execption;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 学成在线项目异常类</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建 2023/12/13 19:50</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">XueChengPlusException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">RuntimeException</span>&#123;<br>    <span class="hljs-keyword">private</span> String errMessage;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">XueChengPlusException</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">super</span>();<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">XueChengPlusException</span><span class="hljs-params">(String errMessage)</span> &#123;<br>        <span class="hljs-built_in">super</span>(errMessage);<br>        <span class="hljs-built_in">this</span>.errMessage = errMessage;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getErrMessage</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> errMessage;<br>    &#125;<br><br>    <span class="hljs-comment">// 抛出通用信息</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cast</span><span class="hljs-params">(CommonError commonError)</span>&#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XueChengPlusException</span>(commonError.getErrMessage());<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cast</span><span class="hljs-params">(String errMessage)</span>&#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XueChengPlusException</span>(errMessage);<br>    &#125;<br><br><br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>响应用户的统一类型</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.base.execption;<br><br><span class="hljs-keyword">import</span> java.io.Serializable;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 响应用户的统一类型</span><br><span class="hljs-comment"> * 和前端约定返回的异常信息模型</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建 2023/12/13 19:52</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RestErrorResponse</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> &#123;<br>    <span class="hljs-keyword">private</span> String errMessage;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">RestErrorResponse</span><span class="hljs-params">(String errMessage)</span> &#123;<br>        <span class="hljs-built_in">this</span>.errMessage = errMessage;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">RestErrorResponse</span><span class="hljs-params">(String errMessage)</span> &#123;<br>        <span class="hljs-built_in">this</span>.errMessage = errMessage;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getErrMessage</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> errMessage;<br>    &#125;<br><br><br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>全局异常处理器</strong></p>
<blockquote>
<p><code>@ExceptionHandler</code>  标识于方法或类的注解, 用来表名方法的处理异常类型</p>
<p><code>@ControllerAdvice</code> 	控制器增强, 对@Controller的增强, 和@ExceptionHandler结合使用, 处理MVC的异常信息</p>
<p><code>@ResponseStatus</code>  	是状态代码或返回的原因标记方法或异常类, 标识方法是对某一个<code>错误状态码</code>进行处理</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.base.execption;<br><br><span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;<br><br><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> com.xuecheng.base.execption.CommonError.UNKOWN_ERROR;<br><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.springframework.http.HttpStatus.INTERNAL_SERVER_ERROR;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 全局异常处理器</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建 2023/12/13 19:55</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-meta">@ControllerAdvice</span> <span class="hljs-comment">// 增强类, 基于AOP捕获异常</span><br><span class="hljs-comment">//@RestControllerAdvice = @ControllerAdvice + @ResponseBody</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GlobalExceptionHandler</span> &#123;<br><br>    <span class="hljs-comment">// 对项目自定义异常进行处理 &#x27;internal_server_error&#x27; -&gt; &#x27;自定义异常语句&#x27;</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-meta">@ExceptionHandler(XueChengPlusException.class)</span><br>    <span class="hljs-meta">@ResponseStatus(INTERNAL_SERVER_ERROR)</span><br>    <span class="hljs-keyword">public</span> RestErrorResponse <span class="hljs-title function_">customException</span><span class="hljs-params">(XueChengPlusException e)</span>&#123;<br>        <span class="hljs-comment">// 记录异常</span><br>        log.error(<span class="hljs-string">&quot;系统异常: &#123;&#125;&quot;</span>, e.getErrMessage(), e);<br>        <span class="hljs-comment">// 解析出异常信息</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RestErrorResponse</span>(e.getErrMessage());<br>    &#125;<br><br>    <span class="hljs-comment">// 不是项目自定义异常 &#x27;internal_server_error&#x27; -&gt; &#x27;执行过程异常，请重试。&#x27;</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-meta">@ExceptionHandler(Exception.class)</span><br>    <span class="hljs-meta">@ResponseStatus(INTERNAL_SERVER_ERROR)</span><br>    <span class="hljs-keyword">public</span> RestErrorResponse <span class="hljs-title function_">exception</span><span class="hljs-params">(Exception e)</span> &#123;<br>        log.error(<span class="hljs-string">&quot;系统异常: &#123;&#125;&quot;</span>,e.getMessage(),e);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RestErrorResponse</span>(UNKOWN_ERROR.getErrMessage()); <span class="hljs-comment">// 默认异常</span><br>    &#125;<br><br><br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>修改service</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> CourseBaseInfoDto <span class="hljs-title function_">createCourseBase</span><span class="hljs-params">(Long companyId, AddCourseDto dto)</span> &#123;<br>    <span class="hljs-comment">// 合法性校验</span><br>    <span class="hljs-keyword">if</span> (StringUtils.isBlank(dto.getName())) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XueChengPlusException</span>(<span class="hljs-string">&quot;课程名称为空&quot;</span>);<br>    <span class="hljs-keyword">if</span> (StringUtils.isBlank(dto.getMt())) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XueChengPlusException</span>(<span class="hljs-string">&quot;课程分类为空&quot;</span>);<br>    <span class="hljs-keyword">if</span> (StringUtils.isBlank(dto.getSt())) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XueChengPlusException</span>(<span class="hljs-string">&quot;课程名称为空&quot;</span>);<br>    <span class="hljs-keyword">if</span> (StringUtils.isBlank(dto.getGrade())) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XueChengPlusException</span>(<span class="hljs-string">&quot;课程等级为空&quot;</span>);<br>    <span class="hljs-keyword">if</span> (StringUtils.isBlank(dto.getTeachmode())) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XueChengPlusException</span>(<span class="hljs-string">&quot;教育模式为空&quot;</span>);<br>    <span class="hljs-keyword">if</span> (StringUtils.isBlank(dto.getUsers())) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XueChengPlusException</span>(<span class="hljs-string">&quot;适应人群为空&quot;</span>);<br>    <span class="hljs-keyword">if</span> (StringUtils.isBlank(dto.getCharge())) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XueChengPlusException</span>(<span class="hljs-string">&quot;收费规则为空&quot;</span>);<br><br>    <span class="hljs-comment">// 新增对象</span><br>    <span class="hljs-type">CourseBase</span> <span class="hljs-variable">courseBaseNew</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CourseBase</span>();<br>    <span class="hljs-comment">// 将课程信息赋值给新增对象</span><br>    BeanUtils.copyProperties(dto, courseBaseNew);<br>    <span class="hljs-comment">// 设置审核状态</span><br>    courseBaseNew.setAuditStatus(<span class="hljs-string">&quot;202002&quot;</span>);<br>    <span class="hljs-comment">// 设置发布状态</span><br>    courseBaseNew.setStatus(<span class="hljs-string">&quot;203001&quot;</span>);<br>    <span class="hljs-comment">// 机构id</span><br>    courseBaseNew.setCompanyId(companyId);<br>    <span class="hljs-comment">// 添加时间</span><br>    courseBaseNew.setCreateDate(LocalDateTime.now());<br>    <span class="hljs-comment">// 插入课程基本信息表</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">insert</span> <span class="hljs-operator">=</span> courseBaseMapper.insert(courseBaseNew);<br>    <span class="hljs-keyword">if</span> (insert &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XueChengPlusException</span>(<span class="hljs-string">&quot;新增课程基本信息失败&quot;</span>);<br><br>    <span class="hljs-comment">// 向课程营销表保存课程营销信息</span><br>    <span class="hljs-type">CourseMarket</span> <span class="hljs-variable">courseMarketNew</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CourseMarket</span>();<br>    BeanUtils.copyProperties(dto, courseMarketNew);<br>    <span class="hljs-type">Long</span> <span class="hljs-variable">courseId</span> <span class="hljs-operator">=</span> courseBaseNew.getId();<br>    courseMarketNew.setId(courseId);<br>    <span class="hljs-comment">// 向课程营销表插入数据或更新数据</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> saveCourseMarket(courseMarketNew);<br>    <span class="hljs-keyword">if</span> (i&lt;=<span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XueChengPlusException</span>(<span class="hljs-string">&quot;保存课程营销信息失败&quot;</span>);<br><br>    <span class="hljs-comment">// 查询课程基本信息及营销信息并返回</span><br>    <span class="hljs-keyword">return</span> getCourseBaseInfo(courseId);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>测试</strong></p>
<p>故意将必填项课程名称设置为空</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213203014473.png" srcset="/img/loading.gif" lazyload alt="image-20231213203014473"></p>
<p>联调: 收费且费用填0</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213203142283.png" srcset="/img/loading.gif" lazyload alt="image-20231213203142283"></p>
<h4 id="JSR303-校验"><a href="#JSR303-校验" class="headerlink" title="JSR303 校验"></a>JSR303 校验</h4><blockquote>
<p>前端请求后端接口传输参数, controller和 service 都要<code>校验</code></p>
<p>controller 中校验请求参数的合法性, 包括必填项校验, 数据格式校验(是否符合日期格式等)</p>
<p>service  校验业务规则相关的内容, 比如: 课程已经审核通过所以提交失败</p>
<p>Service中根据业务规则去校验不方便写成通用代码，Controller中则可以将校验的代码写成通用代码</p>
</blockquote>
<p>直接使用提供的注解校验即可</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213203712220.png" srcset="/img/loading.gif" lazyload alt="image-20231213203712220"></p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213203753785.png" srcset="/img/loading.gif" lazyload alt="image-20231213203753785"></p>
<p>改造新增课程业务, 在dto类添加注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.content.model.dto;<br><br><span class="hljs-keyword">import</span> com.xuecheng.base.execption.ValidationGroups;<br><span class="hljs-keyword">import</span> io.swagger.annotations.ApiModel;<br><span class="hljs-keyword">import</span> io.swagger.annotations.ApiModelProperty;<br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-keyword">import</span> javax.validation.constraints.NotEmpty;<br><span class="hljs-keyword">import</span> javax.validation.constraints.Size;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> Mr.M</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description</span> 添加课程dto</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@date</span> 2022/9/7 17:40</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@ApiModel(value = &quot;AddCourseDto&quot;, description = &quot;新增课程基本信息&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AddCourseDto</span> &#123;<br><br>    <span class="hljs-meta">@NotEmpty(groups = &#123;ValidationGroups.Insert.class&#125;,message = &quot;添加课程名称不能为空&quot;)</span><br>    <span class="hljs-meta">@NotEmpty(groups = &#123;ValidationGroups.Update.class&#125;,message = &quot;修改课程名称不能为空&quot;)</span><br><span class="hljs-comment">//    @NotEmpty(message = &quot;课程名称不能为空&quot;)</span><br>    <span class="hljs-meta">@ApiModelProperty(value = &quot;课程名称&quot;, required = true)</span><br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-comment">// 校验报错, 抛出异常 MethodArgumentNotValidException</span><br>    <span class="hljs-comment">// @NotEmpty 表示属性不能为空</span><br>    <span class="hljs-meta">@NotEmpty(message = &quot;适用人群不能为空&quot;)</span><br>    <span class="hljs-comment">// @Size表示限制属性内容的长短</span><br>    <span class="hljs-meta">@Size(message = &quot;适用人群内容过少&quot;, min = 10)</span><br>    <span class="hljs-meta">@ApiModelProperty(value = &quot;适用人群&quot;, required = true)</span><br>    <span class="hljs-keyword">private</span> String users;<br><br>    <span class="hljs-meta">@ApiModelProperty(value = &quot;课程标签&quot;)</span><br>    <span class="hljs-keyword">private</span> String tags;<br><br>    <span class="hljs-meta">@NotEmpty(message = &quot;课程分类不能为空&quot;)</span><br>    <span class="hljs-meta">@ApiModelProperty(value = &quot;大分类&quot;, required = true)</span><br>    <span class="hljs-keyword">private</span> String mt;<br><br>    <span class="hljs-meta">@NotEmpty(message = &quot;课程分类不能为空&quot;)</span><br>    <span class="hljs-meta">@ApiModelProperty(value = &quot;小分类&quot;, required = true)</span><br>    <span class="hljs-keyword">private</span> String st;<br><br>    <span class="hljs-meta">@NotEmpty(message = &quot;课程等级不能为空&quot;)</span><br>    <span class="hljs-meta">@ApiModelProperty(value = &quot;课程等级&quot;, required = true)</span><br>    <span class="hljs-keyword">private</span> String grade;<br><br>    <span class="hljs-meta">@ApiModelProperty(value = &quot;教学模式（普通，录播，直播等）&quot;, required = true)</span><br>    <span class="hljs-keyword">private</span> String teachmode;<br><br>    <span class="hljs-meta">@ApiModelProperty(value = &quot;课程介绍&quot;)</span><br>    <span class="hljs-keyword">private</span> String description;<br><br>    <span class="hljs-meta">@ApiModelProperty(value = &quot;课程图片&quot;, required = true)</span><br>    <span class="hljs-keyword">private</span> String pic;<br><br>    <span class="hljs-meta">@NotEmpty(message = &quot;收费规则不能为空&quot;)</span><br>    <span class="hljs-meta">@ApiModelProperty(value = &quot;收费规则，对应数据字典&quot;, required = true)</span><br>    <span class="hljs-keyword">private</span> String charge;<br><br>    <span class="hljs-meta">@ApiModelProperty(value = &quot;价格&quot;)</span><br>    <span class="hljs-keyword">private</span> Float price;<br>    <span class="hljs-meta">@ApiModelProperty(value = &quot;原价&quot;)</span><br>    <span class="hljs-keyword">private</span> Float originalPrice;<br><br><br>    <span class="hljs-meta">@ApiModelProperty(value = &quot;qq&quot;)</span><br>    <span class="hljs-keyword">private</span> String qq;<br><br>    <span class="hljs-meta">@ApiModelProperty(value = &quot;微信&quot;)</span><br>    <span class="hljs-keyword">private</span> String wechat;<br>    <span class="hljs-meta">@ApiModelProperty(value = &quot;电话&quot;)</span><br>    <span class="hljs-keyword">private</span> String phone;<br><br>    <span class="hljs-meta">@ApiModelProperty(value = &quot;有效期&quot;)</span><br>    <span class="hljs-keyword">private</span> Integer validDays;<br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>有时候在同一个属性上设置一个校验规则不能满足要求，比如：订单编号由系统生成，在添加订单时要求订单编号为空，在更新 订单时要求订单编写不能为空。此时就用到了分组校验，同一个属性定义多个校验规则属于不同的分组，比如：添加订单定义@NULL规则属于insert分组，更新订单定义@NotEmpty规则属于update分组，insert和update是分组的名称，是可以修改的</p>
</blockquote>
<p><strong>定义校验组合类</strong></p>
<blockquote>
<p>分组后注意 如果规定了某一组, <code>其他组</code>&amp;&amp;<code>没有加入任何组</code>的校验注解不会生效</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.base.execption;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 校验分组</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建 2023/12/13 20:48</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ValidationGroups</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Insert</span>&#123;&#125;;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Update</span>&#123;&#125;;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Delete</span>&#123;&#125;;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>controller开启校验</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ApiOperation(&quot;新增课程基础信息&quot;)</span><br><span class="hljs-meta">@PostMapping(&quot;/course&quot;)</span> <span class="hljs-comment">// @Validated 开启校验</span><br><span class="hljs-keyword">public</span> CourseBaseInfoDto <span class="hljs-title function_">createCourseBase</span><span class="hljs-params">(</span><br><span class="hljs-params">        <span class="hljs-meta">@RequestBody</span> <span class="hljs-meta">@Validated(&#123;ValidationGroups.Insert.class&#125;)</span> AddCourseDto addCourseDto)</span>&#123;<br>    <span class="hljs-comment">// 机构id, 由于认证系统没有上限暂时硬编码</span><br>    <span class="hljs-type">Long</span> <span class="hljs-variable">companyId</span> <span class="hljs-operator">=</span> <span class="hljs-number">1232141425L</span>;<br>    <span class="hljs-keyword">return</span> courseBaseInfoService.createCourseBase(companyId, addCourseDto);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>校验失败, 则抛出异常 MethodArgumentNotValidException, 在全局异常捕获他</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 校验异常 MethodArgumentNotValidException, 把报错信息放入集合收集为字符串返回</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-meta">@ExceptionHandler(MethodArgumentNotValidException.class)</span><br><span class="hljs-meta">@ResponseStatus(INTERNAL_SERVER_ERROR)</span><br><span class="hljs-keyword">public</span> RestErrorResponse <span class="hljs-title function_">exception</span><span class="hljs-params">(MethodArgumentNotValidException e)</span> &#123;<br>    <span class="hljs-type">BindingResult</span> <span class="hljs-variable">bindingResult</span> <span class="hljs-operator">=</span> e.getBindingResult();<br>    <span class="hljs-comment">// 将错误信息放在 msgList</span><br>    List&lt;String&gt; msgList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    bindingResult.getFieldErrors().forEach(item-&gt;msgList.add(item.getDefaultMessage()));<br>    <span class="hljs-comment">// 拼接错误信息为字符串</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> StringUtils.join(msgList, <span class="hljs-string">&quot;,&quot;</span>);<br>    log.error(<span class="hljs-string">&quot;系统异常: &#123;&#125;&quot;</span>, msg);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RestErrorResponse</span>(msg);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>测试</strong></p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213210424490.png" srcset="/img/loading.gif" lazyload alt="image-20231213210424490"></p>
<p>如果@注解 校验无法满足要求, 其他方案</p>
<ol>
<li>手写校验代码</li>
<li>自定义校验规则注解</li>
</ol>
<blockquote>
<p>面试: </p>
<ol>
<li>系统如何处理异常?</li>
</ol>
<p>自定义一个统一的异常处理器捕获并处理异常</p>
<p>使用控制器增强注解@ControllerAdvice和异常处理注解@ExceptinoHandler来实现</p>
<p>​	a. 处理自定义异常:    	根据校验结果主动抛出自定义异常类对象, 抛出异常指定详细的异常信息,  异常处理器捕获异常信息记录异常日志并响应给用户</p>
<p>​	b. 处理未知异常: 接口执行过程中一些<code>运行时异常</code>也会由异常处理器统一捕获, 记录异常日志, 统一响应用户500错误,  在异常处理器可以针对<code>某个异常类型</code>进行单独处理</p>
<ol start="2">
<li>请求参数的合法性校验如何做?</li>
</ol>
<p>使用基于JSR303校验框架实现, SpringBoot提供JSR303的支持, 是spring-boot-starter-validation 包括很多校验规则, 只需要在<code>模型类</code>通过<code>注解</code>指定校验<code>规则</code>, 在<code>controller</code>方法开启校验</p>
</blockquote>
<h3 id="修改课程"><a href="#修改课程" class="headerlink" title="修改课程"></a>修改课程</h3><h4 id="需求分析-3"><a href="#需求分析-3" class="headerlink" title="需求分析"></a>需求分析</h4><p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213214404537.png" srcset="/img/loading.gif" lazyload alt="image-20231213214404537"></p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213214452277.png" srcset="/img/loading.gif" lazyload alt="image-20231213214452277"></p>
<p>进入编辑界面显示当前课程的信息, 修改成功自动进入<code>课程计划编辑页面</code></p>
<h4 id="数据模型-1"><a href="#数据模型-1" class="headerlink" title="数据模型"></a>数据模型</h4><p>包括2张表, 课程基本信息表, 课程营销信息表</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213214637577.png" srcset="/img/loading.gif" lazyload alt="image-20231213214637577"></p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213214645689.png" srcset="/img/loading.gif" lazyload alt="image-20231213214645689"></p>
<ol>
<li>课程编辑界面, 显示课程信息, 根据课程id查询课程基本和课程营销信息, 显示在表单上</li>
<li>编辑, 提交, 修改课程提交的数据比新增课程多了一项<code>课程id</code>, 因为修改课程需要<code>针对某个课程进行修改</code></li>
<li>保存数据, 编辑完成保存<code>课程基础信息</code>和<code>课程营销信息</code>, 更新课程基本信息表的<code>修改人, 修改时间</code></li>
</ol>
<h4 id="接口定义-1"><a href="#接口定义-1" class="headerlink" title="接口定义"></a>接口定义</h4><p>controller</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ApiOperation(&quot;修改课程基础信息&quot;)</span><br><span class="hljs-meta">@PutMapping(&quot;/course&quot;)</span><br><span class="hljs-keyword">public</span> CourseBaseInfoDto <span class="hljs-title function_">modifyCourseBase</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> <span class="hljs-meta">@Validated</span> EditCourseDto editCourseDto)</span>&#123;<br>    <span class="hljs-comment">// 机构id, 由于认证系统没有上线暂时硬编码</span><br>    <span class="hljs-type">Long</span> <span class="hljs-variable">companyId</span> <span class="hljs-operator">=</span> <span class="hljs-number">1232141425L</span>;<br>    <span class="hljs-keyword">return</span> courseBaseInfoService.updateCourseBase(companyId, editCourseDto);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>service</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 修改课程基础信息</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> editCourseDto</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> CourseBaseInfoDto <span class="hljs-title function_">updateCourseBase</span><span class="hljs-params">(Long companyId, EditCourseDto editCourseDto)</span> &#123;<br>    <span class="hljs-comment">// 课程id</span><br>    <span class="hljs-type">Long</span> <span class="hljs-variable">courseId</span> <span class="hljs-operator">=</span> editCourseDto.getId();<br>    <span class="hljs-type">CourseBase</span> <span class="hljs-variable">courseBaseDB</span> <span class="hljs-operator">=</span> courseBaseMapper.selectById(courseId);<br>    <span class="hljs-keyword">if</span> (courseBaseDB == <span class="hljs-literal">null</span>)<br>        XueChengPlusException.cast(<span class="hljs-string">&quot;课程不存在&quot;</span>);<br><br>    <span class="hljs-comment">// 校验本机构只能修改本机构的课程</span><br>    <span class="hljs-keyword">if</span> (!courseBaseDB.getCompanyId().equals(companyId))<br>        XueChengPlusException.cast(<span class="hljs-string">&quot;本机构只能修改本机构的课程&quot;</span>);<br><br>    <span class="hljs-comment">// 需要修改两个表 --&gt; 课程表 和 营销表</span><br><br>    <span class="hljs-comment">// 修改课程表</span><br>    BeanUtils.copyProperties(editCourseDto, courseBaseDB);<br>    courseBaseDB.setChangeDate(LocalDateTime.now());<br>    courseBaseMapper.updateById(courseBaseDB);<br><br>    <span class="hljs-comment">// 修改营销表</span><br>    <span class="hljs-type">CourseMarket</span> <span class="hljs-variable">courseMarket</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CourseMarket</span>();<br>    BeanUtils.copyProperties(editCourseDto, courseMarket);<br>    <span class="hljs-built_in">this</span>.saveCourseMarket(courseMarket);<br><br>    <span class="hljs-comment">// 查询课程信息</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.getCourseBaseInfo(courseId);<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">### 修改课程信息</span><br>PUT &#123;&#123;content_host&#125;&#125;/content/course<br>Content-Type: application/json<br><br>&#123;<br>  <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;132&quot;</span>,<br>  <span class="hljs-string">&quot;mt&quot;</span>: <span class="hljs-string">&quot;1-1&quot;</span>,<br>  <span class="hljs-string">&quot;st&quot;</span>: <span class="hljs-string">&quot;1-1-1&quot;</span>,<br>  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;java&quot;</span>,<br>  <span class="hljs-string">&quot;pic&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-string">&quot;teachmode&quot;</span>: <span class="hljs-string">&quot;200002&quot;</span>,<br>  <span class="hljs-string">&quot;users&quot;</span>: <span class="hljs-string">&quot;初级人员12331564869&quot;</span>,<br>  <span class="hljs-string">&quot;tags&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-string">&quot;grade&quot;</span>: <span class="hljs-string">&quot;204001&quot;</span>,<br>  <span class="hljs-string">&quot;description&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-string">&quot;charge&quot;</span>: <span class="hljs-string">&quot;201000&quot;</span>,<br>  <span class="hljs-string">&quot;price&quot;</span>: 0,<br>  <span class="hljs-string">&quot;originalPrice&quot;</span>:0,<br>  <span class="hljs-string">&quot;qq&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-string">&quot;wechat&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-string">&quot;phone&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-string">&quot;validDays&quot;</span>: 365<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231213232628012.png" srcset="/img/loading.gif" lazyload alt="image-20231213232628012"></p>
<h3 id="查询课程计划"><a href="#查询课程计划" class="headerlink" title="查询课程计划"></a>查询课程计划</h3><h4 id="需求分析-4"><a href="#需求分析-4" class="headerlink" title="需求分析"></a>需求分析</h4><p>课程基本信息添加或修改成功后将自动进入课程计划编辑器</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214105555310.png" srcset="/img/loading.gif" lazyload alt="image-20231214105555310"></p>
<p>课程计划即课程大纲目录，课程计划分为两级： <code>大章节</code>和<code>小章节</code></p>
<h4 id="数据模型-2"><a href="#数据模型-2" class="headerlink" title="数据模型"></a>数据模型</h4><p>课程计划表 teachplan </p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214105757191.png" srcset="/img/loading.gif" lazyload alt="image-20231214105757191"></p>
<p>每个课程计划有所属的课程有两个级别, 第一级为大章节, grade为1, 第二级为小章节, grade为2</p>
<p>第二级的pid是第一级的id, 第一级的pid是0</p>
<p>课程计划列表还有课程计划关联的视频信息  , teachplan_midia表</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214110323538.png" srcset="/img/loading.gif" lazyload alt="image-20231214110323538"></p>
<p>两张表是一对一关系, 每一个课程只能在 teachplan_midia表存在一个视频</p>
<h4 id="接口定义-2"><a href="#接口定义-2" class="headerlink" title="接口定义"></a>接口定义</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><code class="hljs json">Java<br>GET /teachplan/<span class="hljs-number">22</span>/tree-nodes<br><br> <span class="hljs-punctuation">[</span><br>      <span class="hljs-punctuation">&#123;</span><br>         <span class="hljs-attr">&quot;changeDate&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;courseId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">74</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;cousePubId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;createDate&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;endTime&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;grade&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2&quot;</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;isPreview&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;0&quot;</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;mediaType&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">112</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;pname&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;第1章基础知识&quot;</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;startTime&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;status&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">113</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;teachPlanTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>            <span class="hljs-punctuation">&#123;</span><br>               <span class="hljs-attr">&quot;changeDate&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;courseId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">74</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;cousePubId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;createDate&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;endTime&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;grade&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;3&quot;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;isPreview&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1&quot;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;mediaType&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;001002&quot;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">113</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;pname&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;第1节项目概述&quot;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;startTime&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;status&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">115</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;teachPlanTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;teachplanMedia&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;courseId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">74</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;coursePubId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;mediaFilename&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2.avi&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;mediaId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">41</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;teachplanId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">115</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><br>               <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-punctuation">&#125;</span><br>         <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;teachplanMedia&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-punctuation">&#123;</span><br>         <span class="hljs-attr">&quot;changeDate&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;courseId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">74</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;cousePubId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;createDate&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;endTime&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;grade&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2&quot;</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;isPreview&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;0&quot;</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;mediaType&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">112</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;pname&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;第2章快速入门&quot;</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;startTime&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;status&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">242</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;teachPlanTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>            <span class="hljs-punctuation">&#123;</span><br>               <span class="hljs-attr">&quot;changeDate&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;courseId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">74</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;cousePubId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;createDate&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;endTime&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;grade&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;3&quot;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;isPreview&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1&quot;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;mediaType&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;001002&quot;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">242</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;pname&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;第1节搭建环境&quot;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;startTime&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;status&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">244</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;teachPlanTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;teachplanMedia&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;courseId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">74</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;coursePubId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;mediaFilename&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;3.avi&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;mediaId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">42</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;teachplanId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">244</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><br>               <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-punctuation">&#123;</span><br>               <span class="hljs-attr">&quot;changeDate&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;courseId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">74</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;cousePubId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;createDate&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;endTime&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;grade&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;3&quot;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;isPreview&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;0&quot;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;mediaType&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;001002&quot;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;orderby&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;parentid&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">242</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;pname&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;第2节项目概述&quot;</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;startTime&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;status&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">245</span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;teachPlanTreeNodes&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>               <span class="hljs-attr">&quot;teachplanMedia&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;courseId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">74</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;coursePubId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;mediaFilename&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1a.avi&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;mediaId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">39</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;teachplanId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">245</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><br>               <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-punctuation">&#125;</span><br>         <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-attr">&quot;teachplanMedia&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><br>      <span class="hljs-punctuation">&#125;</span><br>   <span class="hljs-punctuation">]</span><br><br></code></pre></td></tr></table></figure>

<blockquote>
<p><strong>树形结构解决的两种思路:</strong> </p>
<ol>
<li>在java逻辑中解决(之前新增分类)</li>
<li>在mapper逻辑中解决(这个接口)</li>
</ol>
</blockquote>
<p><strong>controller</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.content.api;<br><br><span class="hljs-keyword">import</span> com.xuecheng.content.model.dto.TeachplanDto;<br><span class="hljs-keyword">import</span> com.xuecheng.content.service.TeachplanService;<br><span class="hljs-keyword">import</span> io.swagger.annotations.Api;<br><span class="hljs-keyword">import</span> io.swagger.annotations.ApiImplicitParam;<br><span class="hljs-keyword">import</span> io.swagger.annotations.ApiOperation;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PathVariable;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * TeachplanController</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建 2023/12/14 11:13</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Api(value = &quot;课程计划编辑接口&quot;,tags = &quot;课程计划编辑接口&quot;)</span><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TeachplanController</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    TeachplanService teachplanService;<br><br><br>    <span class="hljs-meta">@ApiOperation(&quot;查询课程计划树形结构&quot;)</span><br>    <span class="hljs-meta">@ApiImplicitParam()</span><br>    <span class="hljs-meta">@GetMapping(&quot;/teachplan/&#123;courseId&#125;/tree-nodes&quot;)</span><br>    <span class="hljs-keyword">public</span> List&lt;TeachplanDto&gt; <span class="hljs-title function_">getTreeNodes</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long courseId)</span>&#123;<br>        <span class="hljs-keyword">return</span> teachplanService.findTeachplanTree(courseId);<br>    &#125;<br><br><br><br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>service</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.content.service.impl;<br><br><span class="hljs-keyword">import</span> com.xuecheng.content.mapper.TeachplanMapper;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.dto.TeachplanDto;<br><span class="hljs-keyword">import</span> com.xuecheng.content.service.TeachplanService;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 付广建 2023/12/14 11:20</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TeachplanServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">TeachplanService</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    TeachplanMapper teachplanMapper;<br><br>    <span class="hljs-comment">// 查询课程计划树形结构</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> List&lt;TeachplanDto&gt; <span class="hljs-title function_">findTeachplanTree</span><span class="hljs-params">(Long courseId)</span> &#123;<br>        <span class="hljs-keyword">return</span> teachplanMapper.selectTreeNodes(courseId);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>mapper</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.content.mapper;<br><br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.core.mapper.BaseMapper;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.dto.TeachplanDto;<br><span class="hljs-keyword">import</span> com.xuecheng.content.model.po.Teachplan;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 课程计划 Mapper 接口</span><br><span class="hljs-comment"> * &lt;/p&gt;</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> itcast</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">TeachplanMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;Teachplan&gt; &#123;<br><br>    <span class="hljs-comment">// 查询课程计划树形结构</span><br>    List&lt;TeachplanDto&gt; <span class="hljs-title function_">selectTreeNodes</span><span class="hljs-params">(Long courseId)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>重点是xml文件, 利用resultMap对查询结果进行组装, 之前是利用stream流在service中进行组装, 思想是一样的</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.xuecheng.content.mapper.TeachplanMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 通用查询映射结果 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;BaseResultMap&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;com.xuecheng.content.model.po.Teachplan&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;pname&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;pname&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;parentid&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;parentid&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;grade&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;grade&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;media_type&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;mediaType&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;start_time&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;startTime&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;end_time&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;endTime&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;description&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;description&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;timelength&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;timelength&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;orderby&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;orderby&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;course_id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;courseId&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;course_pub_id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;coursePubId&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;status&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;status&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;is_preview&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;isPreview&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;create_date&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;createDate&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;change_date&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;changeDate&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 通用查询结果列 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">sql</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;Base_Column_List&quot;</span>&gt;</span><br>        id, pname, parentid, grade, media_type, start_time, end_time, description, timelength, orderby, course_id, course_pub_id, status, is_preview, create_date, change_date<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">sql</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 课程分类树型结构查询映射结果 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;treeNodeResultMap&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;com.xuecheng.content.model.dto.TeachplanDto&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- 一级数据映射 --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;one_id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;one_pname&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;pname&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;one_parentid&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;parentid&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;media_type&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;mediaType&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;start_time&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;startTime&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;end_time&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;endTime&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;one_orderby&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;orderby&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;one_courseId&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;courseId&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;one_coursePubId&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;coursePubId&quot;</span>/&gt;</span><br>        <span class="hljs-comment">&lt;!-- 一级中包含多个二级数据 --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">collection</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;teachPlanTreeNodes&quot;</span> <span class="hljs-attr">ofType</span>=<span class="hljs-string">&quot;com.xuecheng.content.model.dto.TeachplanDto&quot;</span>&gt;</span><br>            <span class="hljs-comment">&lt;!-- 二级数据映射 --&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">id</span>     <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;two_id&quot;</span>        <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span> /&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;two_pname&quot;</span>      <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;pname&quot;</span> /&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;two_parentid&quot;</span>     <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;parentid&quot;</span> /&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;two_grade&quot;</span>  <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;grade&quot;</span> /&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;two_mediaType&quot;</span>   <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;mediaType&quot;</span> /&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;two_stratTime&quot;</span>   <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;startTime&quot;</span> /&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;two_endTime&quot;</span>   <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;endTime&quot;</span> /&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;two_orderby&quot;</span>   <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;orderby&quot;</span> /&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;two_courseId&quot;</span>   <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;courseId&quot;</span> /&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;two_coursePubId&quot;</span>   <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;coursePubId&quot;</span> /&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">association</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;teachplanMedia&quot;</span> <span class="hljs-attr">javaType</span>=<span class="hljs-string">&quot;com.xuecheng.content.model.po.TeachplanMedia&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;teachplanMeidaId&quot;</span>   <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span> /&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;mediaFilename&quot;</span>   <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;mediaFilename&quot;</span> /&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;mediaId&quot;</span>   <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;mediaId&quot;</span> /&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;two_id&quot;</span>   <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;teachplanId&quot;</span> /&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;two_courseId&quot;</span>   <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;courseId&quot;</span> /&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;two_coursePubId&quot;</span>   <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;coursePubId&quot;</span> /&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">association</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">collection</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectTreeNodes&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;treeNodeResultMap&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;java.lang.Long&quot;</span>&gt;</span><br>        SELECT one.id            one_id,<br>               one.pname         one_pname,<br>               one.parentid      one_parentid,<br>               one.grade         one_grade,<br>               one.media_type    one_mediaType,<br>               one.start_time    one_stratTime,<br>               one.end_time      one_endTime,<br>               one.orderby       one_orderby,<br>               one.course_id     one_courseId,<br>               one.course_pub_id one_coursePubId,<br>               two.id            two_id,<br>               two.pname         two_pname,<br>               two.parentid      two_parentid,<br>               two.grade         two_grade,<br>               two.media_type    two_mediaType,<br>               two.start_time    two_startTime,<br>               two.end_time      two_endTime,<br>               two.orderby       two_orderby,<br>               two.course_id     two_courseId,<br>               two.course_pub_id two_coursePubId,<br>               m1.media_fileName mediaFilename,<br>               m1.id             teachplanMeidaId,<br>               m1.media_id       mediaId<br><br>        FROM `teachplan` one<br>                 INNER JOIN teachplan two ON two.parentid = one.id<br>                 LEFT JOIN teachplan_media m1 on two.id = m1.teachplan_id<br>        WHERE one.parentid = 0<br>          and one.course_id = #&#123;courseId&#125;<br>        order by one.orderby, two.orderby<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="测试-1"><a href="#测试-1" class="headerlink" title="测试"></a><strong>测试</strong></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">### 查询课程计划树形结构<br>GET &#123;&#123;content_host&#125;&#125;/content/teachplan/<span class="hljs-number">117</span>/tree-nodes<br><br></code></pre></td></tr></table></figure>

<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214121739423.png" srcset="/img/loading.gif" lazyload alt="image-20231214121739423"></p>
<h3 id="新增-修改计划"><a href="#新增-修改计划" class="headerlink" title="新增&#x2F;修改计划"></a>新增&#x2F;修改计划</h3><h4 id="需求分析-5"><a href="#需求分析-5" class="headerlink" title="需求分析"></a>需求分析</h4><p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214145130166.png" srcset="/img/loading.gif" lazyload alt="image-20231214145130166"></p>
<p>添加章 添加小节 新增成功自动刷新课程计划列表, 新增的课程自动排序到最后, 点击章 节 名称, 修改名称 选择是否免费</p>
<h4 id="数据模型-3"><a href="#数据模型-3" class="headerlink" title="数据模型"></a>数据模型</h4><p>1、新增第一级课程计划</p>
<p>名称默认为：新章名称 [点击修改]</p>
<p>grade：1</p>
<p>orderby: 所属课程中同级别下排在最后</p>
<p>2、新增第二级课程计划</p>
<p>名称默认为：新小节名称 [点击修改]</p>
<p>grade：2</p>
<p>orderby: 所属课程计划中排在最后</p>
<p>3、修改第一级、第二级课程计划的名称，修改第二级课程计划是否免费</p>
<h4 id="接口定义-3"><a href="#接口定义-3" class="headerlink" title="接口定义"></a>接口定义</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs json">### 新增课程计划--章<span class="hljs-punctuation">,</span>当grade为<span class="hljs-number">1</span>时parentid为<span class="hljs-number">0</span><br>POST /teachplan<br>Content-Type<span class="hljs-punctuation">:</span> application/json<br><br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;courseId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">74</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;parentid&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;grade&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;pname&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;新章名称 [点击修改]&quot;</span><br><span class="hljs-punctuation">&#125;</span><br>### 新增课程计划--节<br>POST <span class="hljs-punctuation">&#123;</span><span class="hljs-punctuation">&#123;</span>content_host<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span>/content/teachplan<br>Content-Type<span class="hljs-punctuation">:</span> application/json<br><br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;courseId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">74</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;parentid&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">247</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;grade&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;pname&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;小节名称 [点击修改]&quot;</span><br><span class="hljs-punctuation">&#125;</span><br><br></code></pre></td></tr></table></figure>

<p>同一个接口接收新增和修改两个业务, 以是否传递<code>课程计划id</code>判断是新增还是修改</p>
<p>如果传递了课程计划id, 说明要<code>修改</code>课程计划, 否则是<code>新增</code>课程计划</p>
<p><strong>controller</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ApiOperation(&quot;课程计划创建或修改&quot;)</span><br><span class="hljs-meta">@PostMapping(&quot;/teachplan&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">saveTeachplan</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> SaveTeachplanDto teachplanDto)</span>&#123;<br>    teachplanService.saveTeachplan(teachplanDto);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>service</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 课程计划创建或修改</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">saveTeachplan</span><span class="hljs-params">(SaveTeachplanDto teachplanDto)</span> &#123;<br>    <span class="hljs-comment">// 课程计划id</span><br>    <span class="hljs-type">Long</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> teachplanDto.getId();<br>    <span class="hljs-comment">// 修改课程计划</span><br>    <span class="hljs-keyword">if</span> (id!=<span class="hljs-literal">null</span>)&#123;<br>        <span class="hljs-type">Teachplan</span> <span class="hljs-variable">teachplan</span> <span class="hljs-operator">=</span> teachplanMapper.selectById(id);<br>        BeanUtils.copyProperties(teachplanDto, teachplan);<br>        teachplanMapper.updateById(teachplan);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// 取出同父同级别的课程计划数量</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> getTeachplanCount(teachplanDto.getCourseId(), teachplanDto.getParentid());<br>        <span class="hljs-type">Teachplan</span> <span class="hljs-variable">teachplanNew</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Teachplan</span>();<br>        BeanUtils.copyProperties(teachplanDto, teachplanNew);<br>        teachplanNew.setOrderby(count+<span class="hljs-number">1</span>);<br>        teachplanMapper.insert(teachplanNew);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description</span> 获取最新的排序号</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> courseId  课程id</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> parentId  父课程计划id</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> int 最新排序号</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> Mr.M</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@date</span> 2022/9/9 13:43</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getTeachplanCount</span><span class="hljs-params">(Long courseId, Long parentId)</span> &#123;<br>    LambdaQueryWrapper&lt;Teachplan&gt; lqw = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LambdaQueryWrapper</span>&lt;&gt;();<br>    lqw.eq(Teachplan::getCourseId, courseId);<br>    lqw.eq(Teachplan::getParentid, parentId);<br>    <span class="hljs-keyword">return</span> teachplanMapper.selectCount(lqw);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>测试</strong></p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214164531094.png" srcset="/img/loading.gif" lazyload alt="image-20231214164531094"></p>
<blockquote>
<p>Bug 修改 : 前端页面添加的大章节无法显示</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214171959494.png" srcset="/img/loading.gif" lazyload alt="image-20231214171959494"></p>
<p>TeachplanMapper.xml</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214171916310.png" srcset="/img/loading.gif" lazyload alt="image-20231214171916310"></p>
</blockquote>
<h3 id="实战环境"><a href="#实战环境" class="headerlink" title="实战环境"></a>实战环境</h3><p>流程:</p>
<ol>
<li>组长将实战的初始代码提交到git仓库</li>
<li>组员从此仓库clone项目</li>
<li>组内讨论实战功能需求和接口</li>
<li>根据组的情况分工, 每人至少写一个接口并测试通过, 提交到仓库</li>
</ol>
<blockquote>
<p>注意:  每人开发接口创建自己的service controller 接口和类, 不要出现多人共用一个文件的情况</p>
</blockquote>
<ol start="5">
<li>功能开发完毕组成员拉下所有代码, 交叉测试, 测出来的bug记录在word文档给组长汇总</li>
<li>根据bug记录进行修复自己接口的bug, 修复完成并测试没问题提交git</li>
</ol>
<h3 id="删除课程计划"><a href="#删除课程计划" class="headerlink" title="删除课程计划"></a>删除课程计划</h3><h4 id="需求分析-6"><a href="#需求分析-6" class="headerlink" title="需求分析"></a>需求分析</h4><p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214172750117.png" srcset="/img/loading.gif" lazyload alt="image-20231214172750117"></p>
<p>删除一级大章节要求大章节下面<code>没有小章节</code>方可删除</p>
<p>删除二级小章节同时需要将<code>teachplan_media</code>表关联的信息(视频)删除</p>
<h4 id="接口定义-4"><a href="#接口定义-4" class="headerlink" title="接口定义"></a>接口定义</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json">Java<br>Request URL<span class="hljs-punctuation">:</span> /content/teachplan/<span class="hljs-number">246</span><br>Request Method<span class="hljs-punctuation">:</span> DELETE<br><br>如果失败返回：<br><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;errCode&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;120409&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;errMessage&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;课程计划信息还有子级信息，无法操作&quot;</span><span class="hljs-punctuation">&#125;</span><br><br>如果成功：状态码<span class="hljs-number">200</span>，不返回信息<br><br></code></pre></td></tr></table></figure>

<p><strong>controller</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ApiOperation(&quot;删除课程计划信息&quot;)</span><br><span class="hljs-meta">@DeleteMapping(&quot;/teachplan/&#123;id&#125;&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">removeTeachplan</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span>&#123;<br>    teachplanService.deleteTeachplan(id);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>service</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 删除课程计划信息</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteTeachplan</span><span class="hljs-params">(Long id)</span> &#123;<br>    <span class="hljs-comment">// 0.首先看他是大是小</span><br>    <span class="hljs-type">Teachplan</span> <span class="hljs-variable">teachplan</span> <span class="hljs-operator">=</span> teachplanMapper.selectById(id);<br>    <span class="hljs-keyword">if</span>(teachplan.getGrade()==<span class="hljs-number">1</span>)&#123;<br>        <span class="hljs-comment">// 1.删除大章节, 如果大章节下面有小章节, 则不能删除</span><br>        <span class="hljs-type">Teachplan</span> <span class="hljs-variable">teachplanSmall</span> <span class="hljs-operator">=</span> teachplanMapper.selectOne(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LambdaQueryWrapper</span>&lt;Teachplan&gt;().eq(Teachplan::getParentid, id));<br>        <span class="hljs-keyword">if</span> (teachplanSmall != <span class="hljs-literal">null</span>) &#123;<br>            XueChengPlusException.cast(<span class="hljs-string">&quot;关联了小的章节, 不能删除&quot;</span>);<br>        &#125;<br>        teachplanMapper.deleteById(teachplan);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// 2.删除小章节, ok</span><br>        teachplanMapper.deleteById(teachplan);<br>        <span class="hljs-comment">// 3.删除对应的 teachplan_media 表</span><br>        teachplanMediaMapper.delete(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LambdaQueryWrapper</span>&lt;TeachplanMedia&gt;().eq(TeachplanMedia::getTeachplanId, id));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>测试</strong></p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214175223100.png" srcset="/img/loading.gif" lazyload alt="image-20231214175223100"></p>
<h3 id="课程计划排序"><a href="#课程计划排序" class="headerlink" title="课程计划排序"></a>课程计划排序</h3><h4 id="需求分析-7"><a href="#需求分析-7" class="headerlink" title="需求分析"></a>需求分析</h4><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@ApiOperation</span>(<span class="hljs-string">&quot;课程计划排序&quot;</span>)<br><span class="hljs-variable">@PostMapping</span>(<span class="hljs-string">&quot;/teachplan/&#123;moveType&#125;/&#123;id&#125;&quot;</span>)<br>public void <span class="hljs-built_in">moveCourse</span>(<span class="hljs-variable">@PathVariable</span> Long id, <span class="hljs-variable">@PathVariable</span> String moveType)&#123;<br>    <span class="hljs-selector-tag">teachplanService</span><span class="hljs-selector-class">.moveCourse</span>(id, moveType);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214175317252.png" srcset="/img/loading.gif" lazyload alt="image-20231214175317252"></p>
<p>上移表示将课程计划向上移动。</p>
<p>下移表示将课程计划向下移动。</p>
<p>向上移动后和上边同级的课程计划交换位置，可以将两个课程计划的<code>排序字段值进行交换</code>。</p>
<p>向下移动后和下边同级的课程计划交换位置，可以将两个课程计划的排序字段值进行交换。</p>
<h4 id="接口定义-5"><a href="#接口定义-5" class="headerlink" title="接口定义"></a>接口定义</h4><p>向下移动</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json">Request URL<span class="hljs-punctuation">:</span> http<span class="hljs-punctuation">:</span><span class="hljs-comment">//localhost:8601/api/content/teachplan/movedown/43</span><br>Request Method<span class="hljs-punctuation">:</span> POST<br><br></code></pre></td></tr></table></figure>

<p>向上移动</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json">Java<br>Request URL<span class="hljs-punctuation">:</span> http<span class="hljs-punctuation">:</span><span class="hljs-comment">//localhost:8601/api/content/teachplan/moveup/43</span><br>Request Method<span class="hljs-punctuation">:</span> POST<br><br></code></pre></td></tr></table></figure>

<p>每次移动传递两个参数：</p>
<p>1、移动类型: movedown和moveup</p>
<p>2、课程计划id</p>
<p><strong>controller</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ApiOperation(&quot;课程计划排序&quot;)</span><br><span class="hljs-meta">@PostMapping(&quot;/teachplan/&#123;moveType&#125;/&#123;id&#125;&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">moveCourse</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id, <span class="hljs-meta">@PathVariable</span> String moveType)</span>&#123;<br>    teachplanService.moveCourse(id, moveType);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>service</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 课程计划排序</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">moveCourse</span><span class="hljs-params">(Long id, String moveType)</span> &#123;<br>    <span class="hljs-type">Teachplan</span> <span class="hljs-variable">teachplan</span> <span class="hljs-operator">=</span> teachplanMapper.selectById(id);<br>    <span class="hljs-comment">// 获取和层级和orderby, 章节和小节移动不同</span><br>    <span class="hljs-type">Integer</span> <span class="hljs-variable">grade</span> <span class="hljs-operator">=</span> teachplan.getGrade();<br>    <span class="hljs-type">Integer</span> <span class="hljs-variable">orderby</span> <span class="hljs-operator">=</span> teachplan.getOrderby();<br>    <span class="hljs-comment">// 章节移动是比较同一课程id下的orderby</span><br>    <span class="hljs-type">Long</span> <span class="hljs-variable">courseId</span> <span class="hljs-operator">=</span> teachplan.getCourseId();<br>    <span class="hljs-comment">// 小节移动是比较同一章节id下的orderby</span><br>    <span class="hljs-type">Long</span> <span class="hljs-variable">parentid</span> <span class="hljs-operator">=</span> teachplan.getParentid();<br><br>    <span class="hljs-comment">// 上移</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;moveup&quot;</span>.equals(moveType)) &#123;<br>        <span class="hljs-comment">// 章节移动</span><br>        <span class="hljs-keyword">if</span> (grade == <span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-comment">// select * from teachplan where grade = 1 and course_id = 26 and orderby &lt; 4 order by orderby desc limit 1</span><br>            LambdaQueryWrapper&lt;Teachplan&gt; lqw = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LambdaQueryWrapper</span>&lt;&gt;();<br>            lqw.eq(Teachplan::getGrade, <span class="hljs-number">1</span>)<br>                    .eq(Teachplan::getCourseId, courseId)<br>                    .lt(Teachplan::getOrderby, orderby)<br>                    .orderByDesc(Teachplan::getOrderby)<br>                    .last(<span class="hljs-string">&quot;LIMIT 1&quot;</span>);<br>            <span class="hljs-type">Teachplan</span> <span class="hljs-variable">teachplanDB</span> <span class="hljs-operator">=</span> teachplanMapper.selectOne(lqw);<br><br>            changeOrder(teachplanDB, teachplan);<br><br>        &#125;<br>        <span class="hljs-comment">// 小节移动</span><br>        <span class="hljs-keyword">if</span> (grade == <span class="hljs-number">2</span>) &#123;<br>            <span class="hljs-comment">// select * from teachplan where grade = 2 and parent_id = 26 and orderby &lt; 4 order by orderby desc limit 1</span><br>            LambdaQueryWrapper&lt;Teachplan&gt; lqw = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LambdaQueryWrapper</span>&lt;&gt;();<br>            lqw.eq(Teachplan::getGrade, <span class="hljs-number">2</span>)<br>                    .eq(Teachplan::getParentid, parentid)<br>                    .lt(Teachplan::getOrderby, orderby)<br>                    .orderByDesc(Teachplan::getOrderby)<br>                    .last(<span class="hljs-string">&quot;LIMIT 1&quot;</span>);<br>            <span class="hljs-type">Teachplan</span> <span class="hljs-variable">teachplanDB</span> <span class="hljs-operator">=</span> teachplanMapper.selectOne(lqw);<br>            changeOrder(teachplanDB, teachplan);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// 下移</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;movedown&quot;</span>.equals(moveType)) &#123;<br>        <span class="hljs-comment">// 章节移动</span><br>        <span class="hljs-keyword">if</span> (grade == <span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-comment">// select * from teachplan where grade = 1 and course_id = 26 and orderby &gt; 1 order by orderby limit 1</span><br>            LambdaQueryWrapper&lt;Teachplan&gt; lqw = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LambdaQueryWrapper</span>&lt;&gt;();<br>            lqw.eq(Teachplan::getGrade, <span class="hljs-number">1</span>)<br>                    .eq(Teachplan::getCourseId, courseId)<br>                    .gt(Teachplan::getOrderby, orderby)<br>                    .orderByAsc(Teachplan::getOrderby)<br>                    .last(<span class="hljs-string">&quot;LIMIT 1&quot;</span>);<br>            <span class="hljs-type">Teachplan</span> <span class="hljs-variable">teachplanDB</span> <span class="hljs-operator">=</span> teachplanMapper.selectOne(lqw);<br><br>            changeOrder(teachplanDB, teachplan);<br><br>        &#125;<br>        <span class="hljs-comment">// 小节移动</span><br>        <span class="hljs-keyword">if</span> (grade == <span class="hljs-number">2</span>) &#123;<br>            <span class="hljs-comment">// select * from teachplan where grade = 2 and parent_id = 26 and orderby &lt; 4 order by orderby limit 1</span><br>            LambdaQueryWrapper&lt;Teachplan&gt; lqw = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LambdaQueryWrapper</span>&lt;&gt;();<br>            lqw.eq(Teachplan::getGrade, <span class="hljs-number">2</span>)<br>                    .eq(Teachplan::getParentid, parentid)<br>                    .gt(Teachplan::getOrderby, orderby)<br>                    .orderByAsc(Teachplan::getOrderby)<br>                    .last(<span class="hljs-string">&quot;LIMIT 1&quot;</span>);<br>            <span class="hljs-type">Teachplan</span> <span class="hljs-variable">teachplanDB</span> <span class="hljs-operator">=</span> teachplanMapper.selectOne(lqw);<br>            changeOrder(teachplanDB, teachplan);<br>        &#125;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-comment">// 调换位置 orderby</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">changeOrder</span><span class="hljs-params">(Teachplan teachplanDB, Teachplan teachplan)</span> &#123;<br>    <span class="hljs-keyword">if</span> (teachplanDB == <span class="hljs-literal">null</span>) XueChengPlusException.cast(<span class="hljs-string">&quot;移到头啦, 不能再移动啦&quot;</span>);<br>    <span class="hljs-type">Integer</span> <span class="hljs-variable">orderby1</span> <span class="hljs-operator">=</span> teachplan.getOrderby();<br>    <span class="hljs-type">Integer</span> <span class="hljs-variable">orderby2</span> <span class="hljs-operator">=</span> teachplanDB.getOrderby();<br>    teachplan.setOrderby(orderby2);<br>    teachplanDB.setOrderby(orderby1);<br>    teachplanMapper.updateById(teachplan);<br>    teachplanMapper.updateById(teachplanDB);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="师资管理"><a href="#师资管理" class="headerlink" title="师资管理"></a>师资管理</h3><h4 id="需求分析-8"><a href="#需求分析-8" class="headerlink" title="需求分析"></a>需求分析</h4><p>下一步</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214214329437.png" srcset="/img/loading.gif" lazyload alt="image-20231214214329437"></p>
<p>添加</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214214351329.png" srcset="/img/loading.gif" lazyload alt="image-20231214214351329"></p>
<p>添加成功</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214214407963.png" srcset="/img/loading.gif" lazyload alt="image-20231214214407963"></p>
<p>删除老师, 修改老师</p>
<p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214214445298.png" srcset="/img/loading.gif" lazyload alt="image-20231214214445298"></p>
<blockquote>
<p>注意:</p>
<p>只允许向机构自己的课程添加老师, 删除老师</p>
<p>机构id统一用 1232141425L</p>
</blockquote>
<h4 id="接口定义-6"><a href="#接口定义-6" class="headerlink" title="接口定义"></a>接口定义</h4><p>查询老师</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json">Java<br>get /courseTeacher/list/<span class="hljs-number">75</span><br><span class="hljs-number">75</span>为课程id，请求参数为课程id<br><br>响应结果<br><span class="hljs-punctuation">[</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">23</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;courseId&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">75</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;teacherName&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;张老师&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;position&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;讲师&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;introduction&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;张老师教师简介张老师教师简介张老师教师简介张老师教师简介&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;photograph&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;createDate&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span><br><br></code></pre></td></tr></table></figure>



<p>添加老师</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs json">Java<br>post  /courseTeacher<br><br>请求参数：<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;courseId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">75</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;teacherName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;王老师&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;position&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;教师职位&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;introduction&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;教师简介&quot;</span><br><span class="hljs-punctuation">&#125;</span><br>响应结果：<br><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;courseId&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">75</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;teacherName&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;王老师&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;position&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;教师职位&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;introduction&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;教师简介&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;photograph&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;createDate&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">&#125;</span><br><br></code></pre></td></tr></table></figure>

<p>修改老师</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs json">Java<br>put /courseTeacher<br>请求参数：<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">24</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;courseId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">75</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;teacherName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;王老师&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;position&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;教师职位&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;introduction&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;教师简介&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;photograph&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;createDate&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><br><span class="hljs-punctuation">&#125;</span><br>响应：<br><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;courseId&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">75</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;teacherName&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;王老师&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;position&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;教师职位&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;introduction&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;教师简介&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;photograph&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;createDate&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">&#125;</span><br><br></code></pre></td></tr></table></figure>

<p>删除老师</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json">Java<br>delete /ourseTeacher/course/<span class="hljs-number">75</span>/<span class="hljs-number">26</span><br><br><span class="hljs-number">75</span><span class="hljs-punctuation">:</span>课程id<br><span class="hljs-number">26</span><span class="hljs-punctuation">:</span>教师id，即course_teacher表的主键<br>请求参数：课程id、教师id<br><br>响应：状态码<span class="hljs-number">200</span>，不返回信息<br><br></code></pre></td></tr></table></figure>

<h4 id="测试-2"><a href="#测试-2" class="headerlink" title="测试"></a>测试</h4><p><img src="https://fgj3.oss-cn-beijing.aliyuncs.com/image-20231214232831531.png" srcset="/img/loading.gif" lazyload alt="image-20231214232831531"></p>
<h3 id="删除课程"><a href="#删除课程" class="headerlink" title="删除课程"></a>删除课程</h3><h4 id="需求分析-9"><a href="#需求分析-9" class="headerlink" title="需求分析"></a>需求分析</h4><p>课程的审核状态为<code>未提交</code>时方可删除。</p>
<p>删除课程需要<code>删除课程相关的基本信息</code>、<code>营销信息</code>、<code>课程计划</code>、<code>课程教师信息</code></p>
<h4 id="接口定义-7"><a href="#接口定义-7" class="headerlink" title="接口定义"></a>接口定义</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ApiOperation(&quot;删除课程&quot;)</span><br><span class="hljs-meta">@DeleteMapping(&quot;/course/&#123;courseId&#125;&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteCourse</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long courseId)</span>&#123;<br>    <span class="hljs-type">Long</span> <span class="hljs-variable">companyId</span> <span class="hljs-operator">=</span> <span class="hljs-number">1232141425L</span>;<br>    courseTeacherService.deleteCourse(companyId, courseId);<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 删除课程</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-meta">@Transactional</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteCourse</span><span class="hljs-params">(Long companyId, Long courseId)</span> &#123;<br>    <span class="hljs-type">CourseBase</span> <span class="hljs-variable">courseBase</span> <span class="hljs-operator">=</span> courseBaseMapper.selectById(courseId);<br>    <span class="hljs-comment">// 只能删除本机构的课程</span><br>    <span class="hljs-keyword">if</span> (companyId != courseBase.getCompanyId())<br>        XueChengPlusException.cast(<span class="hljs-string">&quot;只有自己公司的课程允许删除&quot;</span>);<br>    <span class="hljs-comment">// 课程的审核状态为未提交时方可删除</span><br>    <span class="hljs-keyword">if</span>(! (<span class="hljs-string">&quot;202002&quot;</span>.equals(courseBase.getStatus())) )<br>        XueChengPlusException.cast(<span class="hljs-string">&quot;不能删除&quot;</span>);<br>    <span class="hljs-comment">// 删除课程需要删除课程相关的基本信息、营销信息、课程计划、课程教师信息</span><br>    courseBaseMapper.deleteById(courseId);<br>    courseMarketMapper.deleteById(courseId);<br>    teachplanMapper.delete(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LambdaQueryWrapper</span>&lt;Teachplan&gt;().eq(Teachplan::getCourseId, courseId));<br>    courseTeacherMapper.delete(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LambdaQueryWrapper</span>&lt;CourseTeacher&gt;().eq(CourseTeacher::getCourseId, courseId));<br>&#125;<br></code></pre></td></tr></table></figure>


                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E9%A1%B9%E7%9B%AE/" class="category-chain-item">项目</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BF/" class="print-no-link">#学成在线</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>学成在线内容管理模块</div>
      <div>http://example.com/2023/12/21/学成在线内容管理模块/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>fgj</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年12月21日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/12/21/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BF%E5%AA%92%E8%B5%84%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/" title="学成在线媒资管理模块">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">学成在线媒资管理模块</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/12/21/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BF%E5%87%86%E5%A4%87/" title="学成在线准备">
                        <span class="hidden-mobile">学成在线准备</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":173,"height":346},"mobile":{"show":true},"log":false});</script></body>
</html>
